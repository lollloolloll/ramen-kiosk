{
  "master": {
    "tasks": [
      {
        "id": 1,
        "title": "데이터베이스 스키마 및 Drizzle ORM 설정",
        "description": "Drizzle ORM을 SQLite와 함께 설정하고, `users`, `ramens`, `rentalRecords` 테이블 스키마를 `lib/db/schema.ts`에 정의합니다.",
        "details": "`lib/db/schema.ts`에 `users`, `ramens`, `rentalRecords` 테이블을 정의합니다. `users` 테이블은 `id`, `username`, `hashedPassword`, `role` (기본값 'USER')을 포함합니다. `ramens` 테이블은 `id`, `name`, `manufacturer`, `stock`, `imageUrl`을 포함합니다. `rentalRecords` 테이블은 `id`, `userId`, `ramenId`, `rentalDate`를 포함합니다. Drizzle ORM을 사용하여 SQLite 데이터베이스 연결을 설정합니다.",
        "testStrategy": "Drizzle-kit을 사용하여 마이그레이션을 실행하고, 데이터베이스에 테이블이 올바르게 생성되었는지 확인합니다. 더미 데이터를 삽입하고 쿼리하여 ORM이 제대로 작동하는지 검증합니다.",
        "priority": "high",
        "dependencies": [],
        "status": "done",
        "subtasks": [
          {
            "id": 1,
            "title": "Drizzle ORM 및 SQLite 드라이버 설치 및 초기 설정",
            "description": "Drizzle ORM과 SQLite 데이터베이스 드라이버(예: `better-sqlite3`)를 프로젝트에 설치하고, Drizzle 설정을 위한 초기 파일(`drizzle.config.ts`)을 생성합니다.",
            "dependencies": [],
            "details": "`npm install drizzle-orm better-sqlite3` 및 개발 의존성으로 `npm install -D drizzle-kit`을 실행합니다. 프로젝트 루트에 `drizzle.config.ts` 파일을 생성하여 스키마 파일 경로와 마이그레이션 폴더를 지정합니다.\n<info added on 2025-10-17T12:27:10.724Z>\nDrizzle ORM 및 SQLite 드라이버 설치 및 초기 설정이 완료되었습니다. `package.json`에는 `drizzle-orm`과 개발 의존성으로 `drizzle-kit`이 올바르게 추가되었으며, SQLite 드라이버로는 `better-sqlite3` 대신 `@libsql/client`가 사용되었습니다. 프로젝트 루트에 `drizzle.config.ts` 파일이 생성되어 스키마 파일 경로(`lib/db/schema.ts`)와 마이그레이션 폴더(`drizzle`)를 지정하고 `turso` 드라이버를 사용하도록 설정되었음을 확인했습니다.\n</info added on 2025-10-17T12:27:10.724Z>",
            "status": "done",
            "testStrategy": "프로젝트의 `package.json` 파일에서 Drizzle 관련 패키지들이 올바르게 추가되었는지 확인하고, `drizzle.config.ts` 파일이 생성되었는지 검증합니다."
          },
          {
            "id": 2,
            "title": "`users`, `ramens`, `rentalRecords` 테이블 스키마 정의",
            "description": "`lib/db/schema.ts` 파일에 `users`, `ramens`, `rentalRecords` 테이블에 대한 Drizzle ORM 스키마를 정의합니다. 각 테이블의 필드와 데이터 타입을 정확히 명시하고 관계를 설정합니다.",
            "dependencies": [1],
            "details": "`lib/db/schema.ts` 파일에 다음 테이블 스키마를 정의합니다: `users` (id, username, hashedPassword, role='USER'), `ramens` (id, name, manufacturer, stock, imageUrl), `rentalRecords` (id, userId, ramenId, rentalDate). 외래 키 제약 조건 및 인덱스를 포함합니다.",
            "status": "done",
            "testStrategy": "스키마 파일이 문법적으로 올바른지 확인하고, DrizzleKit의 `drizzle-kit check` 명령을 사용하여 스키마 정의에 오류가 없는지 검증합니다."
          },
          {
            "id": 3,
            "title": "SQLite 데이터베이스 연결 및 Drizzle ORM 인스턴스 생성",
            "description": "지정된 SQLite 데이터베이스 파일(`sqlite.db`)에 대한 연결을 설정하고, 정의된 스키마를 사용하여 Drizzle ORM 데이터베이스 인스턴스를 초기화하고 내보냅니다.",
            "dependencies": [1, 2],
            "details": "`lib/db/index.ts` 파일에 `better-sqlite3`를 사용하여 `sqlite.db` 파일에 대한 데이터베이스 연결을 생성하고, `drizzle-orm/better-sqlite3`의 `drizzle` 함수를 사용하여 Drizzle DB 인스턴스를 생성 및 내보냅니다.",
            "status": "done",
            "testStrategy": "데이터베이스 연결 코드가 포함된 파일이 오류 없이 컴파일되는지 확인합니다. 간단한 `console.log(db)`를 추가하여 Drizzle DB 인스턴스가 성공적으로 생성되었는지 확인합니다."
          },
          {
            "id": 4,
            "title": "DrizzleKit 마이그레이션 구성 및 첫 마이그레이션 생성",
            "description": "DrizzleKit 마이그레이션 시스템을 구성하고, 정의된 스키마를 기반으로 데이터베이스 테이블을 생성하기 위한 첫 번째 마이그레이션 파일을 생성합니다.",
            "dependencies": [1, 2, 3],
            "details": "`drizzle.config.ts`에 `migrationsFolder` 경로를 지정하고, `package.json` 스크립트에 `drizzle-kit generate:sqlite --schema=./lib/db/schema.ts`와 같은 마이그레이션 생성 명령어를 추가합니다. 명령어를 실행하여 마이그레이션 파일을 생성하고 그 내용을 검토합니다.",
            "status": "done",
            "testStrategy": "명령어를 실행하여 `drizzle/migrations` 폴더에 마이그레이션 SQL 파일이 성공적으로 생성되었는지 확인합니다. 생성된 SQL 스크립트 파일 내용을 검토하여 `users`, `ramens`, `rentalRecords` 테이블 생성 쿼리가 포함되어 있는지 수동으로 검증합니다."
          }
        ]
      },
      {
        "id": 2,
        "title": "TailwindCSS 및 shadcn/ui 구성",
        "description": "프로젝트에 TailwindCSS를 설정하고 shadcn/ui 컴포넌트 라이브러리를 초기화합니다.",
        "details": "`tailwind.config.js`를 구성하고, `shadcn/ui`를 설치 및 초기화하여 UI 컴포넌트를 사용할 준비를 합니다. `components/ui/` 디렉토리에 필요한 컴포넌트들을 추가합니다.",
        "testStrategy": "간단한 shadcn/ui 컴포넌트(예: Button)를 페이지에 추가하여 스타일이 올바르게 적용되는지 시각적으로 확인합니다.",
        "priority": "medium",
        "dependencies": [],
        "status": "done",
        "subtasks": [
          {
            "id": 1,
            "title": "Tailwind CSS 설치 및 기본 구성",
            "description": "프로젝트에 Tailwind CSS를 설치하고, `tailwind.config.js` 파일을 설정하여 Tailwind의 기능을 활성화합니다. PostCSS 설정도 포함합니다.",
            "dependencies": [],
            "details": "npm 또는 yarn을 사용하여 `tailwindcss`, `postcss`, `autoprefixer`를 설치합니다. `npx tailwindcss init -p` 명령을 실행하여 `tailwind.config.js`와 `postcss.config.js` 파일을 생성하고, `tailwind.config.js`의 `content` 배열을 프로젝트 파일 경로에 맞게 업데이트합니다.",
            "status": "done",
            "testStrategy": "개발 서버를 실행한 후, 간단한 HTML 요소에 Tailwind 클래스를 적용하여 스타일이 올바르게 적용되는지 시각적으로 확인합니다."
          },
          {
            "id": 2,
            "title": "shadcn/ui CLI 설치 및 프로젝트 초기화",
            "description": "shadcn/ui 라이브러리를 사용하기 위해 CLI를 설치하고 현재 프로젝트에 맞게 초기화합니다. 테마 및 기타 설정을 구성합니다.",
            "dependencies": [1],
            "details": "`npx shadcn-ui@latest init` 명령어를 사용하여 shadcn/ui를 프로젝트에 설치합니다. 이 과정에서 Base 색상, 테마, CSS 변수 등과 같은 초기 구성 옵션을 선택하고 `components.json` 파일을 생성합니다. Tailwind CSS가 올바르게 설정되어 있는지 확인해야 합니다.",
            "status": "done",
            "testStrategy": "`components.json` 파일이 생성되었는지 확인하고, 초기화 과정에서 에러가 발생하지 않았는지 터미널 로그를 통해 검증합니다."
          },
          {
            "id": 3,
            "title": "기본 shadcn/ui 컴포넌트 추가 및 기능 확인",
            "description": "shadcn/ui에서 가장 기본적인 컴포넌트인 `Button`과 `Input`을 프로젝트에 추가하고, 이들이 의도한 대로 동작하고 스타일이 적용되는지 확인합니다.",
            "dependencies": [2],
            "details": "`npx shadcn-ui@latest add button input` 명령을 사용하여 `Button`과 `Input` 컴포넌트를 프로젝트에 추가합니다. `app/page.tsx` 또는 임시 테스트 페이지에 이 컴포넌트들을 임포트하여 렌더링하고, 클릭 및 입력 등의 상호작용이 올바르게 작동하며 Tailwind CSS 스타일이 적용되는지 확인합니다.\n<info added on 2025-10-17T12:36:09.224Z>\n`npx shadcn-ui@latest add button input` 명령을 실행했습니다. 사용자에게 'y'를 입력하여 설치를 진행하도록 요청했습니다. 설치가 완료되면 이 서브태스크를 완료로 표시하겠습니다.\n</info added on 2025-10-17T12:36:09.224Z>",
            "status": "done",
            "testStrategy": "테스트 페이지에 추가된 `Button`과 `Input` 컴포넌트의 시각적 스타일(색상, 크기, 폰트 등)이 예상대로인지 확인합니다. `Button` 클릭, `Input`에 텍스트 입력 등의 기본 상호작용이 정상 작동하는지 수동으로 테스트합니다."
          }
        ]
      },
      {
        "id": 3,
        "title": "사용자 등록 및 로그인 UI 구현",
        "description": "React Hook Form과 Zod를 사용하여 `/login` 및 `/register` UI 페이지를 생성합니다.",
        "details": "`app/(auth)/login/page.tsx` 및 `app/(auth)/register/page.tsx` 파일을 생성합니다. 각 페이지에 사용자 이름과 비밀번호 입력을 위한 폼을 구현하고, React Hook Form과 Zod를 사용하여 클라이언트 측 유효성 검사를 추가합니다.",
        "testStrategy": "등록 및 로그인 폼이 올바르게 렌더링되고, 유효성 검사 규칙이 예상대로 작동하는지 수동으로 테스트합니다.",
        "priority": "high",
        "dependencies": [2],
        "status": "done",
        "subtasks": [
          {
            "id": 1,
            "title": "사용자 인증 Zod 유효성 검사 스키마 정의",
            "description": "로그인 및 등록 폼에 사용할 사용자 이름과 비밀번호에 대한 Zod 유효성 검사 스키마를 `lib/validators/auth.ts` 파일에 정의합니다. 각 스키마는 필수 필드, 최소 길이 등의 규칙을 포함해야 합니다.",
            "dependencies": [],
            "details": "`lib/validators/auth.ts` 파일을 생성하고 `loginSchema`와 `registerSchema`를 정의합니다. `username`은 최소 3자, `password`는 최소 6자 이상으로 설정하며, 필수 필드로 지정합니다.",
            "status": "done",
            "testStrategy": "정의된 Zod 스키마가 유효한 데이터와 유효하지 않은 데이터에 대해 예상대로 동작하는지 유닛 테스트를 작성하거나 콘솔에서 직접 검증합니다."
          },
          {
            "id": 2,
            "title": "/login 페이지 UI 및 React Hook Form 구조 구현",
            "description": "`app/(auth)/login/page.tsx` 파일을 생성하고 로그인 폼의 기본적인 UI(사용자 이름, 비밀번호 입력 필드, 로그인 버튼)를 shadcn/ui 컴포넌트를 사용하여 구성합니다. React Hook Form을 초기화하여 폼 상태를 관리하고 필드를 연결합니다.",
            "dependencies": [2],
            "details": "shadcn/ui의 `Input`, `Button` 컴포넌트를 활용하여 `app/(auth)/login/page.tsx`에 로그인 폼 레이아웃을 만듭니다. `useForm` 훅을 초기화하고 `register` 함수를 각 입력 필드에 적용합니다.",
            "status": "done",
            "testStrategy": "`/login` 페이지에 접속하여 폼 UI가 올바르게 렌더링되는지 시각적으로 확인하고, 입력 필드에 값을 입력했을 때 React Hook Form이 상태를 제대로 관리하는지 확인합니다."
          },
          {
            "id": 3,
            "title": "/register 페이지 UI 및 React Hook Form 구조 구현",
            "description": "`app/(auth)/register/page.tsx` 파일을 생성하고 등록 폼의 기본적인 UI(사용자 이름, 비밀번호 입력 필드, 등록 버튼)를 shadcn/ui 컴포넌트를 사용하여 구성합니다. React Hook Form을 초기화하여 폼 상태를 관리하고 필드를 연결합니다.",
            "dependencies": [2],
            "details": "shadcn/ui의 `Input`, `Button` 컴포넌트를 활용하여 `app/(auth)/register/page.tsx`에 등록 폼 레이아웃을 만듭니다. `useForm` 훅을 초기화하고 `register` 함수를 각 입력 필드에 적용합니다.",
            "status": "done",
            "testStrategy": "`/register` 페이지에 접속하여 폼 UI가 올바르게 렌더링되는지 시각적으로 확인하고, 입력 필드에 값을 입력했을 때 React Hook Form이 상태를 제대로 관리하는지 확인합니다."
          },
          {
            "id": 4,
            "title": "로그인 폼에 Zod 유효성 검사 및 오류/로딩 상태 통합",
            "description": "`/login` 페이지의 React Hook Form에 Subtask 1에서 정의한 Zod 스키마를 `zodResolver`를 사용하여 통합합니다. 폼 제출 시 로딩 상태를 버튼에 표시하고, 유효성 검사 오류 메시지 및 일반적인 폼 제출 오류 메시지를 UI에 적절히 표시합니다.",
            "dependencies": [1, 2],
            "details": "`loginSchema`를 `zodResolver`와 함께 `useForm` 훅에 전달합니다. `formState.errors`를 사용하여 유효성 검사 오류를 각 입력 필드 아래에 표시하고, `formState.isSubmitting`을 사용하여 버튼의 로딩 상태를 토글합니다. 폼 제출 실패 시 `toast` 컴포넌트를 사용해 오류 메시지를 표시합니다.",
            "status": "done",
            "testStrategy": "`/login` 페이지에서 유효하지 않은 데이터를 입력하여 유효성 검사 오류 메시지가 올바르게 표시되는지 확인합니다. 폼 제출 시 버튼의 로딩 상태가 활성화되는지 확인합니다. 폼 제출 후 예상된 오류 메시지가 표시되는지 확인합니다."
          },
          {
            "id": 5,
            "title": "등록 폼에 Zod 유효성 검사 및 오류/로딩 상태 통합",
            "description": "`/register` 페이지의 React Hook Form에 Subtask 1에서 정의한 Zod 스키마를 `zodResolver`를 사용하여 통합합니다. 폼 제출 시 로딩 상태를 버튼에 표시하고, 유효성 검사 오류 메시지 및 일반적인 폼 제출 오류 메시지를 UI에 적절히 표시합니다.",
            "dependencies": [1, 3],
            "details": "`registerSchema`를 `zodResolver`와 함께 `useForm` 훅에 전달합니다. `formState.errors`를 사용하여 유효성 검사 오류를 각 입력 필드 아래에 표시하고, `formState.isSubmitting`을 사용하여 버튼의 로딩 상태를 토글합니다. 폼 제출 실패 시 `toast` 컴포넌트를 사용해 오류 메시지를 표시합니다.",
            "status": "done",
            "testStrategy": "`/register` 페이지에서 유효하지 않은 데이터를 입력하여 유효성 검사 오류 메시지가 올바르게 표시되는지 확인합니다. 폼 제출 시 버튼의 로딩 상태가 활성화되는지 확인합니다. 폼 제출 후 예상된 오류 메시지가 표시되는지 확인합니다."
          }
        ]
      },
      {
        "id": 4,
        "title": "사용자 인증 서버 액션 및 세션 관리 구현",
        "description": "등록 및 로그인 서버 액션을 구현하고, 비밀번호 해싱 및 세션 관리(Next-Auth 또는 JWT 쿠키)를 포함합니다.",
        "details": "`lib/auth/actions.ts`에 `register` 및 `login` 서버 액션을 구현합니다. `register` 액션은 비밀번호를 해싱하여 `users` 테이블에 저장하고, `login` 액션은 제공된 비밀번호를 저장된 해시와 비교하여 세션을 생성합니다. Next-Auth 또는 JWT 기반 쿠키를 사용하여 세션 관리를 설정합니다. `app/api/auth/route.ts`에 API 핸들러를 구성합니다.",
        "testStrategy": "새 사용자를 등록하고 로그인하여 세션이 올바르게 생성되고 유지되는지 확인합니다. 잘못된 자격 증명으로 로그인 시도 시 오류가 발생하는지 테스트합니다.",
        "priority": "high",
        "dependencies": [1, 3],
        "status": "done",
        "subtasks": [
          {
            "id": 1,
            "title": "register 서버 액션 구현 (비밀번호 해싱 및 DB 저장)",
            "description": "새 사용자 등록을 위한 'register' 서버 액션을 'lib/auth/actions.ts'에 구현합니다. 이 액션은 사용자로부터 받은 비밀번호를 안전하게 해싱하여 'users' 테이블에 저장하고, 사용자 생성에 성공하면 응답을 반환합니다.",
            "dependencies": [],
            "details": "'lib/auth/actions.ts' 파일에 'register' 함수를 작성합니다. 'bcrypt' 또는 유사 라이브러리를 사용하여 비밀번호를 해싱하고, 해싱된 비밀번호와 함께 사용자 정보를 'users' 테이블에 삽입합니다. 입력 유효성 검사 및 초기 에러 처리를 포함합니다.",
            "status": "done",
            "testStrategy": "새 사용자 계정을 생성하여 데이터베이스에 올바르게 저장되고 비밀번호가 해싱되었는지 확인합니다. 중복 사용자명/이메일 시도 시 적절한 오류 메시지가 반환되는지 테스트합니다."
          },
          {
            "id": 2,
            "title": "login 서버 액션 구현 (비밀번호 검증 및 세션 준비)",
            "description": "사용자 로그인을 위한 'login' 서버 액션을 'lib/auth/actions.ts'에 구현합니다. 이 액션은 사용자로부터 받은 비밀번호를 저장된 해시와 비교하고, 인증에 성공하면 세션 생성을 위한 초기 단계를 처리합니다.",
            "dependencies": [1],
            "details": "'lib/auth/actions.ts' 파일에 'login' 함수를 작성합니다. 제공된 사용자명(또는 이메일)으로 'users' 테이블에서 사용자를 조회하고, 'bcrypt.compare()'와 같은 함수를 사용하여 비밀번호를 검증합니다. 성공 시 사용자 ID와 같은 정보를 반환하여 다음 세션 관리 단계에서 활용하도록 준비합니다.",
            "status": "done",
            "testStrategy": "유효한 자격 증명으로 로그인 시도 시 성공하는지 확인합니다. 잘못된 자격 증명으로 로그인 시도 시 적절한 오류 메시지가 반환되는지 테스트합니다."
          },
          {
            "id": 3,
            "title": "세션 관리 방식 결정 및 기본 설정 (Next-Auth 또는 JWT)",
            "description": "Next.js 애플리케이션의 세션 관리 방식으로 Next-Auth를 사용할지, 또는 JWT 기반 쿠키 방식을 직접 구현할지 결정하고, 해당 방식에 대한 프로젝트의 초기 설정 및 라이브러리 설치를 수행합니다.",
            "dependencies": [],
            "details": "Next-Auth와 JWT 기반 쿠키 방식의 장단점을 분석하여 프로젝트에 가장 적합한 방식을 선택합니다. 선택된 방식에 따라 필요한 라이브러리(예: 'next-auth', 'jsonwebtoken', 'cookie')를 설치하고, 초기 환경 변수(예: 'AUTH_SECRET', 'JWT_SECRET')를 설정하며, 'next.config.js' 또는 루트 레벨에서 기본 구성을 추가합니다.",
            "status": "done",
            "testStrategy": "선택된 세션 관리 방식의 기본 환경 설정이 오류 없이 완료되고, Next.js 개발 서버가 정상적으로 실행되는지 확인합니다."
          },
          {
            "id": 4,
            "title": "선택된 세션 관리 시스템 구현 (Next-Auth Provider 또는 JWT 로직)",
            "description": "3단계에서 결정된 세션 관리 방식(Next-Auth 또는 JWT 기반)에 따라 실제 세션 토큰 생성, 검증, 쿠키 설정 및 해제 로직을 구현합니다.",
            "dependencies": [2, 3],
            "details": "Next-Auth 선택 시: 'app/api/auth/[...nextauth]/route.ts'에 인증 프로바이더(CredentialsProvider)를 구성합니다. 'authorize' 콜백에서 Subtask 2의 'login' 액션을 호출하여 사용자를 인증하고 세션을 생성합니다. JWT 기반 쿠키 선택 시: Subtask 2의 'login' 액션 성공 후, 'jsonwebtoken'을 사용하여 JWT 토큰을 생성하고 'js-cookie' 또는 유사 라이브러리를 사용하여 안전한 'httpOnly' 쿠키에 토큰을 저장합니다. 토큰 만료 및 갱신 로직을 고려합니다.",
            "status": "done",
            "testStrategy": "성공적인 로그인 후 세션 쿠키(Next-Auth) 또는 JWT 쿠키가 브라우저에 설정되고, 로그아웃 시 제거되는지 확인합니다. 쿠키가 만료되면 사용자가 자동으로 로그아웃되는지 테스트합니다."
          },
          {
            "id": 5,
            "title": "인증 미들웨어 및 세션 헬퍼 함수 구현",
            "description": "보호된 라우트 접근을 제한하고 현재 사용자 세션 정보에 쉽게 접근할 수 있도록 인증 미들웨어 또는 헬퍼 함수를 구현합니다.",
            "dependencies": [4],
            "details": "Next.js 미들웨어('middleware.ts')를 사용하여 특정 라우트 또는 페이지에 대한 접근 권한을 확인합니다. 세션 정보를 가져오는 헬퍼 함수(예: 'getServerSession' for Next-Auth, 또는 JWT 쿠키 파싱 함수)를 생성하여 컴포넌트나 서버 액션에서 현재 인증된 사용자의 데이터를 활용할 수 있도록 합니다.",
            "status": "done",
            "testStrategy": "인증된 사용자만 접근할 수 있는 페이지에 미인증 상태로 접근 시 리다이렉트되는지 확인합니다. 인증된 사용자로 로그인 후, 헬퍼 함수를 통해 사용자 정보(예: 'id', 'username')를 올바르게 가져오는지 테스트합니다."
          },
          {
            "id": 6,
            "title": "인증 관련 API 엔드포인트 및 에러 처리 구현",
            "description": "인증 흐름에 필요한 추가적인 API 엔드포인트(예: Next-Auth 콜백 경로, 또는 JWT 갱신/로그아웃 경로)를 구성하고, 모든 인증 서버 액션 및 API에서 일관된 에러 처리 로직을 구현합니다.",
            "dependencies": [1, 2, 4],
            "details": "Next-Auth 선택 시: 'app/api/auth/[...nextauth]/route.ts' 파일이 올바르게 구성되었는지 다시 확인하고, Next-Auth가 제공하는 콜백 및 라우트가 정상적으로 작동하도록 합니다. JWT 기반 선택 시: 'app/api/auth/logout' 또는 'app/api/auth/refresh'와 같은 추가적인 API 라우트를 구성하여 JWT 쿠키를 제거하거나 갱신하는 로직을 구현합니다. 모든 'register', 'login' 서버 액션 및 관련 API에서 사용자 입력 유효성 검사 실패, 데이터베이스 오류, 인증 실패 등 다양한 시나리오에 대한 일관되고 사용자 친화적인 에러 응답을 구현합니다.",
            "status": "done",
            "testStrategy": "'register' 및 'login' 시나리오에서 의도적으로 잘못된 입력을 주어 에러 메시지가 올바르게 반환되는지 확인합니다. API 엔드포인트가 예상대로 작동하고, 예외적인 상황(예: 네트워크 오류, DB 연결 실패)에서도 안정적으로 에러를 처리하는지 테스트합니다."
          }
        ]
      },
      {
        "id": 5,
        "title": "관리자 RBAC 및 재고 관리 UI 구현",
        "description": "`/admin` 경로를 보호하기 위한 RBAC 로직을 구현하고, 라면 제품을 나열, 추가, 편집, 삭제할 수 있는 관리자 재고 관리 UI를 생성합니다.",
        "details": "`app/(admin)/layout.tsx`에 사용자 역할이 'ADMIN'인지 확인하는 RBAC 로직을 구현하여 관리자 경로에 대한 접근을 제한합니다. `app/(admin)/stock/page.tsx`에 라면 목록을 표시하고, 새 라면을 추가하거나 기존 라면을 편집/삭제할 수 있는 UI를 구현합니다.",
        "testStrategy": "일반 사용자로 `/admin` 경로에 접근 시도 시 접근이 거부되는지 확인합니다. 관리자 계정으로 로그인하여 재고 관리 UI가 올바르게 렌더링되는지 확인합니다.",
        "priority": "high",
        "dependencies": [4],
        "status": "done",
        "subtasks": [
          {
            "id": 1,
            "title": "관리자 RBAC 접근 제어 로직 구현",
            "description": "사용자 역할이 'ADMIN'인지 확인하여 `/admin` 경로에 대한 접근을 제한하는 RBAC(역할 기반 접근 제어) 로직을 `app/(admin)/layout.tsx` 파일에 구현합니다.",
            "dependencies": [1],
            "details": "`app/(admin)/layout.tsx` 내에서 로그인한 사용자의 역할(role)을 확인하는 로직을 추가합니다. 역할이 'ADMIN'이 아니면 접근을 거부하고 로그인 페이지나 접근 거부 페이지로 리디렉션합니다. 사용자 세션에서 역할 정보를 안전하게 가져오는 방법을 고려합니다.",
            "status": "done",
            "testStrategy": "일반 사용자 계정으로 로그인한 후 `/admin` 경로로 직접 이동을 시도하여 접근이 거부되는지 확인합니다. 관리자 계정으로 로그인한 후 `/admin` 경로에 성공적으로 접근되는지 확인합니다."
          },
          {
            "id": 2,
            "title": "라면 재고 목록 표시 UI 구현 (DataTable)",
            "description": "`app/(admin)/stock/page.tsx`에 `shadcn/ui`의 `DataTable` 컴포넌트를 사용하여 모든 라면 제품의 목록을 표시하는 UI를 구현합니다. 각 라면의 이름, 제조사, 재고 수량, 이미지 URL 등을 포함합니다.",
            "dependencies": [1, 2],
            "details": "서버 컴포넌트 또는 서버 액션을 통해 데이터베이스에서 라면 목록 데이터를 가져옵니다. 가져온 데이터를 `shadcn/ui`의 `DataTable` 컴포넌트에 연결하여 표시합니다. 각 라면 항목에 대한 편집 및 삭제 버튼을 포함하는 액션 컬럼을 추가할 준비를 합니다.",
            "status": "done",
            "testStrategy": "관리자 계정으로 로그인하여 `/admin/stock` 페이지에 접속합니다. 데이터베이스에 저장된 라면 목록이 올바르게 테이블 형식으로 표시되는지 확인하고, 빈 목록일 경우 적절한 메시지가 표시되는지 확인합니다."
          },
          {
            "id": 3,
            "title": "새 라면 추가 폼/모달 구현",
            "description": "`app/(admin)/stock/page.tsx`에서 새로운 라면 제품을 추가할 수 있는 폼 또는 모달 UI를 구현합니다. 폼에는 라면 이름, 제조사, 초기 재고, 이미지 URL 등을 입력할 수 있는 필드가 포함됩니다.",
            "dependencies": [1, 2],
            "details": "`shadcn/ui`의 `Dialog` 또는 `Sheet` 컴포넌트를 사용하여 폼을 렌더링하고, `Input` 컴포넌트와 `Button` 컴포넌트로 사용자 입력을 받습니다. 유효성 검사 로직을 포함하고, 폼 제출 시 서버 액션을 호출하여 데이터베이스에 새 라면을 추가합니다.",
            "status": "done",
            "testStrategy": "관리자 계정으로 로그인하여 라면 재고 페이지에서 '새 라면 추가' 버튼을 클릭합니다. 유효한 정보를 입력하여 라면을 추가한 후, 목록에 새로운 라면이 표시되는지 확인합니다. 유효하지 않은 정보 입력 시 유효성 검사가 올바르게 작동하는지 확인합니다."
          },
          {
            "id": 4,
            "title": "라면 편집 폼/모달 구현",
            "description": "기존 라면 제품의 정보를 편집할 수 있는 폼 또는 모달 UI를 구현합니다. 이 폼은 선택된 라면의 현재 데이터를 미리 채우고, 변경 사항을 저장할 수 있도록 합니다.",
            "dependencies": [1, 2],
            "details": "라면 목록의 각 항목 옆에 '편집' 버튼을 추가하고, 이 버튼을 클릭하면 `shadcn/ui`의 `Dialog` 또는 `Sheet` 컴포넌트로 편집 폼이 열립니다. 폼에는 선택된 라면의 현재 데이터가 미리 채워져야 하며, 변경 사항 제출 시 서버 액션을 통해 데이터베이스를 업데이트합니다.",
            "status": "done",
            "testStrategy": "관리자 계정으로 로그인하여 라면 재고 페이지에서 기존 라면의 '편집' 버튼을 클릭합니다. 폼에 현재 정보가 올바르게 채워지는지 확인하고, 정보를 수정한 후 저장하여 목록과 데이터베이스에 변경 사항이 반영되는지 확인합니다."
          },
          {
            "id": 5,
            "title": "라면 삭제 확인 로직 및 UI 구현",
            "description": "라면 목록에서 특정 라면 제품을 삭제할 수 있는 기능과 삭제 전 사용자에게 확인을 요청하는 대화 상자 UI를 구현합니다.",
            "dependencies": [1, 2],
            "details": "라면 목록의 각 항목 옆에 '삭제' 버튼을 추가합니다. 이 버튼을 클릭하면 `shadcn/ui`의 `AlertDialog`와 같은 확인 대화 상자가 나타나 삭제를 최종적으로 확인하도록 합니다. 사용자가 삭제를 확정하면 서버 액션을 호출하여 해당 라면을 데이터베이스에서 제거합니다.",
            "status": "done",
            "testStrategy": "관리자 계정으로 로그인하여 라면 재고 페이지에서 특정 라면의 '삭제' 버튼을 클릭합니다. 확인 대화 상자가 나타나고, '취소'를 클릭하면 라면이 삭제되지 않고, '삭제'를 클릭하면 목록에서 해당 라면이 사라지고 데이터베이스에서도 제거되는지 확인합니다."
          }
        ]
      },
      {
        "id": 6,
        "title": "라면 CRUD 서버 액션/API 구현",
        "description": "관리자 UI에서 라면 제품에 대한 CRUD 작업을 수행하기 위한 서버 액션 또는 API 경로를 연결합니다.",
        "details": "`app/api/ramens/route.ts` 또는 `lib/actions/ramen.ts`와 같은 서버 액션 파일에 라면 생성, 읽기, 업데이트, 삭제 로직을 구현합니다. 이 로직은 `lib/db/queries.ts`의 데이터베이스 함수를 사용하여 `ramens` 테이블을 직접 조작합니다.",
        "testStrategy": "관리자 UI를 통해 라면을 추가, 편집, 삭제하고, 데이터베이스에 변경 사항이 올바르게 반영되는지 확인합니다. 각 CRUD 작업에 대한 API 엔드포인트 또는 서버 액션을 직접 호출하여 테스트할 수도 있습니다.",
        "priority": "high",
        "dependencies": [1, 5],
        "status": "done",
        "subtasks": [
          {
            "id": 1,
            "title": "라면 생성(Create) 서버 액션 구현",
            "description": "관리자 UI를 통해 새로운 라면 제품을 데이터베이스에 추가하는 서버 액션 또는 API 엔드포인트를 구현합니다.",
            "dependencies": [1],
            "details": "`lib/actions/ramen.ts` 또는 `app/api/ramens/route.ts`에 새로운 라면을 생성하는 `createRamen` 함수 또는 POST 핸들러를 구현합니다. `lib/db/queries.ts`의 데이터베이스 함수를 활용하여 `ramens` 테이블에 라면 정보를 삽입합니다. 이름, 제조업체, 재고, 이미지 URL 등 필수 필드를 처리해야 합니다.",
            "status": "done",
            "testStrategy": "API 클라이언트(예: Postman, cURL)를 사용하여 유효한 라면 데이터를 POST 요청으로 전송하고, 데이터베이스에서 해당 라면이 성공적으로 생성되었는지 확인합니다. 관리자 UI 통합 후 UI를 통해서도 생성 기능을 테스트합니다."
          },
          {
            "id": 2,
            "title": "라면 읽기(Read) 서버 액션 구현",
            "description": "데이터베이스에 저장된 모든 라면 목록을 조회하거나 특정 ID의 라면 상세 정보를 조회하는 서버 액션 또는 API 엔드포인트를 구현합니다.",
            "dependencies": [1],
            "details": "`lib/actions/ramen.ts` 또는 `app/api/ramens/route.ts`에 모든 라면을 가져오는 `getAllRamens` 함수와 특정 ID의 라면을 가져오는 `getRamenById` 함수, 또는 해당 GET 핸들러를 구현합니다. `lib/db/queries.ts`의 데이터베이스 함수를 사용하여 `ramens` 테이블에서 데이터를 조회합니다.",
            "status": "done",
            "testStrategy": "API 클라이언트를 사용하여 GET 요청을 보내 모든 라면 목록이 올바르게 반환되는지, 특정 ID로 조회 시 해당 라면 정보가 반환되는지 확인합니다. 데이터베이스의 실제 데이터와 반환된 데이터를 비교하여 정확성을 검증합니다."
          },
          {
            "id": 3,
            "title": "라면 업데이트(Update) 서버 액션 구현",
            "description": "기존 라면 제품의 정보를 관리자 UI를 통해 수정하고 데이터베이스에 반영하는 서버 액션 또는 API 엔드포인트를 구현합니다.",
            "dependencies": [1],
            "details": "`lib/actions/ramen.ts` 또는 `app/api/ramens/route.ts`에 기존 라면 정보를 업데이트하는 `updateRamen` 함수 또는 PUT/PATCH 핸들러를 구현합니다. 특정 라면 ID를 기반으로 `ramens` 테이블의 필드를 수정하며, 이름, 제조업체, 재고, 이미지 URL 등 변경될 수 있는 모든 필드를 처리할 수 있어야 합니다.",
            "status": "done",
            "testStrategy": "API 클라이언트를 사용하여 기존 라면의 ID와 업데이트된 데이터를 포함한 PUT/PATCH 요청을 전송하고, 데이터베이스에서 해당 라면 정보가 올바르게 수정되었는지 확인합니다. 여러 필드 변경 시나리오를 테스트합니다."
          },
          {
            "id": 4,
            "title": "라면 삭제(Delete) 서버 액션 구현",
            "description": "관리자 UI에서 선택된 특정 라면 제품을 데이터베이스에서 영구적으로 제거하는 서버 액션 또는 API 엔드포인트를 구현합니다.",
            "dependencies": [1],
            "details": "`lib/actions/ramen.ts` 또는 `app/api/ramens/route.ts`에 특정 라면을 삭제하는 `deleteRamen` 함수 또는 DELETE 핸들러를 구현합니다. 특정 라면 ID를 기반으로 `ramens` 테이블에서 해당 라면 항목을 삭제하며, 삭제 전 존재 여부 확인 로직을 포함할 수 있습니다.",
            "status": "done",
            "testStrategy": "API 클라이언트를 사용하여 삭제할 라면의 ID로 DELETE 요청을 전송하고, 데이터베이스에서 해당 라면이 성공적으로 삭제되었는지 확인합니다. 존재하지 않는 ID로 삭제 요청 시 적절한 오류 응답이 반환되는지도 테스트합니다."
          },
          {
            "id": 5,
            "title": "라면 CRUD 액션에 대한 서버 측 입력 유효성 검사 추가",
            "description": "라면 생성, 업데이트, 삭제 서버 액션 및 API 엔드포인트로 들어오는 모든 입력 데이터에 대해 서버 측에서 강력한 유효성 검사 로직을 구현합니다.",
            "dependencies": [1, 2, 3, 4],
            "details": "Zod와 같은 스키마 유효성 검사 라이브러리를 사용하여 `createRamen`, `updateRamen`, `deleteRamen` 함수 또는 해당 API 핸들러에 전달되는 데이터(예: 라면 이름이 비어있지 않음, 재고가 0 미만이 아님, ID가 유효한 UUID 형식임)에 대한 유효성 검사 스키마를 정의하고 적용합니다. 유효성 검사에 실패할 경우 사용자에게 명확하고 적절한 오류 응답을 반환하도록 처리합니다.",
            "status": "done",
            "testStrategy": "각 CRUD 작업에 대해 유효하지 않거나 누락된 필드를 포함하는 요청을 보내 유효성 검사 오류 메시지가 올바르게 반환되는지 확인합니다. 예를 들어, 필수 필드를 비워두거나, 숫자여야 할 필드에 문자열을 전달하는 등의 다양한 유효성 검사 실패 시나리오를 테스트합니다."
          }
        ]
      },
      {
        "id": 7,
        "title": "키오스크 라면 목록 UI 구현",
        "description": "사용 가능한 라면 제품을 표시하는 메인 키오스크 UI를 생성합니다.",
        "details": "`app/(kiosk)/page.tsx`에 현재 재고가 있는 라면 목록을 표시하는 UI를 구현합니다. 각 라면은 이름, 제조업체, 이미지 등을 포함하는 `RamenCard.tsx` 컴포넌트를 사용하여 표시됩니다. `lib/db/queries.ts`에서 재고가 0보다 큰 라면을 가져오는 함수를 사용합니다.",
        "testStrategy": "로그인한 사용자로 키오스크 페이지에 접근하여 재고가 있는 라면만 올바르게 표시되는지 확인합니다. 재고가 없는 라면은 표시되지 않아야 합니다.",
        "priority": "high",
        "dependencies": [1, 4],
        "status": "done",
        "subtasks": [
          {
            "id": 1,
            "title": "RamenCard.tsx 컴포넌트 구현",
            "description": "개별 라면의 이름, 제조업체, 이미지, 재고 등 세부 정보를 표시하는 재사용 가능한 `RamenCard.tsx` 컴포넌트를 디자인하고 구현합니다.",
            "dependencies": [2],
            "details": "`components/ramen/RamenCard.tsx` 파일에 Next.js Image 컴포넌트와 TailwindCSS를 사용하여 라면 정보를 시각적으로 매력적으로 표시하는 UI 컴포넌트를 작성합니다. Prop으로는 라면 데이터를 포함하는 객체를 받습니다.",
            "status": "done",
            "testStrategy": "더미 라면 데이터를 사용하여 `RamenCard` 컴포넌트가 다양한 정보(이름, 제조업체, 이미지 URL, 재고)를 올바르게 렌더링하는지 시각적으로 확인합니다. 이미지 로딩 오류 발생 시 대체 텍스트 또는 플레이스홀더가 표시되는지 확인합니다."
          },
          {
            "id": 2,
            "title": "키오스크 메인 페이지 (`app/(kiosk)/page.tsx`) 기본 구조 및 데이터 페칭",
            "description": "`app/(kiosk)/page.tsx`에 키오스크 메인 페이지의 기본 레이아웃을 설정하고, `lib/db/queries.ts`에서 재고가 0보다 큰 라면 목록을 비동기적으로 가져오는 로직을 구현합니다.",
            "dependencies": [1, 4],
            "details": "`app/(kiosk)/page.tsx` 파일을 생성하고 기본적인 페이지 구조를 정의합니다. 서버 컴포넌트에서 `lib/db/queries.ts`에 정의된 `getAvailableRamen` 함수(가정)를 호출하여 라면 데이터를 페칭합니다. 페칭된 데이터는 이후 UI 컴포넌트에 전달될 수 있도록 준비합니다.",
            "status": "done",
            "testStrategy": "키오스크 페이지에 접근하여 개발자 도구의 네트워크 탭 또는 서버 로그를 통해 라면 데이터가 성공적으로 페칭되는지 확인합니다. 데이터베이스에서 재고가 0보다 큰 라면만 페칭되는지 검증합니다."
          },
          {
            "id": 3,
            "title": "키오스크 라면 목록 렌더링 및 빈 상태 처리",
            "description": "페칭된 라면 목록 데이터를 사용하여 `app/(kiosk)/page.tsx`에서 `RamenCard` 컴포넌트들을 반복적으로 렌더링합니다. 재고가 없거나 목록이 비어있는 경우 사용자에게 적절한 안내 메시지를 표시하는 UI를 구현합니다.",
            "dependencies": [1, 2],
            "details": "Subtask 2에서 페칭된 라면 데이터를 그리드 또는 플렉스 레이아웃을 사용하여 `RamenCard` 컴포넌트들을 렌더링합니다. 라면 목록이 비어있을 경우 '현재 재고가 있는 라면이 없습니다.'와 같은 메시지를 페이지 중앙에 표시하는 폴백(fallback) UI를 구현합니다.",
            "status": "done",
            "testStrategy": "로그인한 사용자로 키오스크 페이지에 접근하여 재고가 있는 라면이 `RamenCard` 형태로 올바르게 표시되는지 확인합니다. 모든 라면의 재고를 0으로 설정한 후, 페이지에 '현재 재고가 있는 라면이 없습니다.'와 같은 빈 목록 메시지가 올바르게 표시되는지 확인합니다."
          }
        ]
      },
      {
        "id": 8,
        "title": "라면 대여 기능 구현",
        "description": "로그인한 사용자가 선택한 라면을 대여하고, 재고를 업데이트하며, 거래를 기록하는 `executeRental` 서버 액션을 구현합니다.",
        "details": "`RentalDialog.tsx` 컴포넌트를 구현하여 대여 확인 대화 상자를 표시합니다. `lib/actions/rental.ts`와 같은 서버 액션 파일에 `executeRental` 함수를 구현합니다. 이 함수는 `rentalRecords` 테이블에 새 항목을 생성하고, `ramens` 테이블에서 선택한 라면의 재고를 원자적으로 감소시킵니다. 이 작업은 데이터베이스 트랜잭션으로 처리되어야 합니다.",
        "testStrategy": "로그인한 사용자로 라면을 대여하고, 대여 기록이 생성되고 라면 재고가 감소하는지 확인합니다. 동시에 여러 사용자가 같은 라면을 대여하려고 할 때 재고 감소가 원자적으로 이루어지는지 테스트합니다.",
        "priority": "high",
        "dependencies": [1, 4, 7],
        "status": "done",
        "subtasks": [
          {
            "id": 1,
            "title": "대여 확인 UI 컴포넌트 (RentalDialog.tsx) 구현",
            "description": "사용자가 라면 대여를 최종적으로 확인하고 진행할 수 있는 모달 또는 다이얼로그 컴포넌트를 `RentalDialog.tsx` 파일에 구현합니다. 선택된 라면 정보와 대여 버튼을 포함합니다.",
            "dependencies": [2, 7],
            "details": "`shadcn/ui`의 `Dialog` 컴포넌트를 사용하여 `app/components/rental/RentalDialog.tsx`를 생성합니다. 선택된 라면의 이름, 이미지, 대여 수량 등을 표시하고, '대여' 및 '취소' 버튼을 포함합니다. 대여 버튼 클릭 시 `executeRental` 서버 액션을 호출하도록 준비합니다.",
            "status": "done",
            "testStrategy": "컴포넌트가 올바르게 렌더링되고, 라면 정보가 표시되며, 버튼 클릭 시 콜백 함수가 호출되는지 Storybook 또는 Jest를 사용하여 테스트합니다."
          },
          {
            "id": 2,
            "title": "`executeRental` 서버 액션 스켈레톤 및 입력 유효성 검사 구현",
            "description": "`lib/actions/rental.ts` 파일에 `executeRental` 서버 액션의 기본 구조를 정의하고, 입력으로 받은 `userId`와 `ramenId`의 유효성을 검사하는 로직을 추가합니다.",
            "dependencies": [1, 4],
            "details": "`lib/actions/rental.ts` 파일에 `executeRental(userId: string, ramenId: string)` 함수를 생성합니다. `zod`와 같은 라이브러리를 사용하여 `userId`와 `ramenId`가 유효한 형식인지 검사하고, 유효하지 않을 경우 적절한 오류를 반환합니다. 이 함수는 Next.js 서버 액션으로 선언되어야 합니다.",
            "status": "done",
            "testStrategy": "유효한 ID와 유효하지 않은 ID를 사용하여 `executeRental`을 호출했을 때, 기대하는 성공/실패 응답과 오류 메시지가 반환되는지 단위 테스트를 작성합니다."
          },
          {
            "id": 3,
            "title": "라면 대여 트랜잭션 로직 구현 (기록 생성 및 재고 감소)",
            "description": "`executeRental` 서버 액션 내에서 Drizzle ORM 트랜잭션을 사용하여 `rentalRecords` 테이블에 새 대여 기록을 생성하고, 동시에 `ramens` 테이블에서 해당 라면의 재고를 원자적으로 감소시키는 로직을 구현합니다.",
            "dependencies": [1, 2],
            "details": "`db.transaction`을 사용하여 다음 작업을 원자적으로 수행합니다: 1. `ramens` 테이블에서 `ramenId`에 해당하는 라면의 현재 재고를 조회합니다 (FOR UPDATE). 2. 재고가 1 이상인지 확인하고, 재고가 없으면 트랜잭션을 롤백하고 오류를 반환합니다. 3. `ramens` 테이블의 `stock` 필드를 1 감소시킵니다. 4. `rentalRecords` 테이블에 `userId`, `ramenId`, `rentalDate`를 포함하는 새 기록을 삽입합니다.",
            "status": "done",
            "testStrategy": "재고가 충분한 라면을 대여했을 때, 기록이 생성되고 재고가 1 감소하는지 확인합니다. 동시에 여러 요청이 들어왔을 때, 재고 감소 및 기록 생성이 원자적으로 처리되어 데이터 불일치가 발생하지 않는지 경쟁 조건 테스트를 수행합니다."
          },
          {
            "id": 4,
            "title": "재고 부족 및 기타 대여 관련 예외 처리 구현",
            "description": "`executeRental` 서버 액션 내에서 라면 재고 부족, 존재하지 않는 라면/사용자 ID, 데이터베이스 오류 등 대여 과정에서 발생할 수 있는 다양한 예외 상황을 처리하는 로직을 구현합니다.",
            "dependencies": [3],
            "details": "재고가 0인 라면 대여 시도 시 '재고 부족' 메시지 반환, 존재하지 않는 `ramenId` 또는 `userId` 사용 시 적절한 오류 메시지 반환, 데이터베이스 트랜잭션 중 발생할 수 있는 일반적인 오류를 `try-catch` 블록으로 처리하여 사용자에게 친숙한 오류 메시지를 제공합니다.",
            "status": "done",
            "testStrategy": "재고가 0인 라면을 대여 시도하여 '재고 부족' 오류가 반환되는지 확인합니다. 존재하지 않는 `ramenId` 또는 `userId`로 대여를 시도하여 적절한 오류가 반환되는지 확인합니다. 데이터베이스 오류 상황을 시뮬레이션하여 오류 처리가 작동하는지 확인합니다."
          },
          {
            "id": 5,
            "title": "대여 성공/실패 피드백 및 UI 업데이트 로직 구현",
            "description": "`RentalDialog.tsx`에서 `executeRental` 서버 액션 호출 후, 결과에 따라 사용자에게 대여 성공 또는 실패 메시지를 표시하고, 필요한 경우 UI 상태(예: 재고 정보)를 업데이트하는 로직을 구현합니다.",
            "dependencies": [1, 3],
            "details": "`RentalDialog.tsx` 컴포넌트 또는 호출하는 상위 컴포넌트에서 `useFormStatus` 훅 또는 `useState`를 사용하여 로딩 상태를 관리합니다. `executeRental` 호출이 성공하면 성공 메시지를 표시하고 다이얼로그를 닫으며, 실패하면 오류 메시지를 표시합니다. Next.js의 `revalidatePath` 또는 `revalidateTag`를 사용하여 라면 목록 또는 재고 정보를 새로고침하도록 합니다.",
            "status": "done",
            "testStrategy": "성공적인 대여 후 '대여 완료' 메시지가 표시되고 다이얼로그가 닫히며, 라면 재고 표시가 업데이트되는지 확인합니다. 실패(예: 재고 부족) 시 '대여 실패: 재고 부족'과 같은 오류 메시지가 표시되는지 확인합니다."
          }
        ]
      },
      {
        "id": 9,
        "title": "대여 기록 관리자 페이지 구현",
        "description": "모든 대여 거래의 검색 및 필터링 가능한 로그를 표시하는 관리자 페이지를 구축합니다.",
        "details": "`app/(admin)/records/page.tsx`에 대여 기록을 표시하는 UI를 구현합니다. `rentalRecords` 테이블을 쿼리하고, 사용자 및 라면 데이터와 조인하여 표시합니다. 사용자 ID 또는 날짜 범위와 같은 선택적 필터를 구현합니다.",
        "testStrategy": "관리자 계정으로 로그인하여 대여 기록 페이지에 접근하고, 모든 대여 기록이 올바르게 표시되는지 확인합니다. 필터링 기능이 예상대로 작동하는지 테스트합니다.",
        "priority": "medium",
        "dependencies": [1, 4, 6, 8],
        "status": "done",
        "subtasks": [
          {
            "id": 1,
            "title": "대여 기록 표시를 위한 테이블 UI 구성",
            "description": "`app/(admin)/records/page.tsx` 파일에 shadcn/ui 컴포넌트를 활용하여 대여 기록을 표시할 기본적인 테이블 구조를 만듭니다. 테이블 헤더는 '대여 ID', '사용자명', '라면명', '대여일' 등을 포함해야 합니다.",
            "dependencies": [2],
            "details": "`app/(admin)/records/page.tsx`에서 `DataTable` 컴포넌트 또는 유사한 UI 요소를 사용하여 대여 기록을 표시할 기본 레이아웃을 잡고, 더미 데이터를 사용하여 UI가 올바르게 렌더링되는지 확인합니다.",
            "status": "done",
            "testStrategy": "개발 서버에서 `/admin/records` 경로에 접근하여 기본적인 테이블 UI가 올바르게 렌더링되고 있는지 시각적으로 확인합니다."
          },
          {
            "id": 2,
            "title": "조인된 대여 기록 데이터 페칭 로직 구현",
            "description": "`rentalRecords`, `users`, `ramens` 테이블을 Drizzle ORM을 사용하여 조인하고, 관리자 페이지에 필요한 모든 대여 기록 데이터를 가져오는 서버 액션 또는 데이터 함수를 구현합니다.",
            "dependencies": [1],
            "details": "`lib/data/rentalRecords.ts`와 같은 파일에 `getAllRentalRecords` 함수를 생성하고, Drizzle ORM의 `leftJoin` 또는 `innerJoin`을 사용하여 `rentalRecords`와 `users`, `ramens` 테이블을 연결합니다. 각 기록에 대해 사용자명과 라면명을 포함한 데이터를 반환하도록 구현합니다.",
            "status": "done",
            "testStrategy": "Postman 또는 통합 테스트를 통해 구현된 함수를 호출하여 올바른 데이터가 조인되어 반환되는지 확인하고, 오류가 발생하는 경우를 테스트합니다."
          },
          {
            "id": 3,
            "title": "필터링 UI 컴포넌트 및 상태 관리 구현",
            "description": "사용자 ID를 입력할 수 있는 입력 필드와 날짜 범위(시작일, 종료일)를 선택할 수 있는 DatePicker 컴포넌트를 `app/(admin)/records/page.tsx`에 추가합니다. 이 필터 값들을 관리하는 상태 로직을 구현합니다.",
            "dependencies": [1, 2],
            "details": "shadcn/ui의 `Input` 컴포넌트를 사용자 ID 필터로, `DatePicker` 컴포넌트를 날짜 범위 필터로 활용합니다. `useState` 또는 `useReducer` 훅을 사용하여 필터 값을 관리하고, 값이 변경될 때마다 페이지 URL에 쿼리 파라미터로 반영되도록 `useRouter` 훅과 연동합니다.",
            "status": "done",
            "testStrategy": "페이지에 필터 UI가 올바르게 표시되는지 확인하고, 필터 값을 변경할 때 URL 쿼리 파라미터가 정확하게 업데이트되는지 브라우저 개발자 도구를 통해 확인합니다."
          },
          {
            "id": 4,
            "title": "사용자 ID 기반 대여 기록 필터링 로직 구현",
            "description": "Subtask 2에서 구현한 데이터 페칭 로직에 사용자 ID 쿼리 파라미터가 있을 경우, 해당 사용자 ID에 해당하는 대여 기록만 필터링하여 반환하도록 기능을 추가합니다.",
            "dependencies": [2, 3],
            "details": "`getAllRentalRecords` 함수 또는 관련 데이터 페칭 로직을 수정하여 `userId` 파라미터를 받을 수 있도록 합니다. 이 파라미터가 제공되면 Drizzle ORM의 `where` 절을 사용하여 `rentalRecords.userId`와 일치하는 기록만 가져오도록 쿼리를 동적으로 구성합니다.",
            "status": "done",
            "testStrategy": "특정 사용자 ID로 필터링했을 때, 해당 사용자의 대여 기록만 정확히 표시되는지, 그리고 잘못된 사용자 ID를 입력했을 때 결과가 올바르게 처리되는지 확인합니다."
          },
          {
            "id": 5,
            "title": "날짜 범위 기반 대여 기록 필터링 로직 구현",
            "description": "Subtask 2에서 구현한 데이터 페칭 로직에 시작일과 종료일 쿼리 파라미터가 있을 경우, 해당 날짜 범위 내의 대여 기록만 필터링하여 반환하도록 기능을 추가합니다.",
            "dependencies": [2, 3],
            "details": "`getAllRentalRecords` 함수 또는 관련 데이터 페칭 로직을 수정하여 `startDate`와 `endDate` 파라미터를 받을 수 있도록 합니다. 이 파라미터가 제공되면 Drizzle ORM의 `where` 절과 `between` 연산자를 사용하여 `rentalRecords.rentalDate`가 지정된 날짜 범위 내에 있는 기록만 가져오도록 쿼리를 동적으로 구성합니다.",
            "status": "done",
            "testStrategy": "특정 날짜 범위로 필터링했을 때, 해당 범위 내의 대여 기록만 정확히 표시되는지, 날짜가 누락되거나 잘못된 범위일 때 오류 없이 처리되는지 확인합니다."
          }
        ]
      },
      {
        "id": 11,
        "title": "사용자 스키마 업데이트 및 신규 등록 필드 적용",
        "description": "generalUsers 테이블 스키마를 prd.md에 명시된 대로 name, phoneNumber, birthDate, school, personalInfoConsent 필드를 포함하도록 업데이트합니다. 그리고 pin필드를 삭제합니다. 회원가입 UI와 서버 액션을 수정하여 새 필드를 반영합니다.",
        "details": "",
        "testStrategy": "",
        "status": "done",
        "dependencies": [1],
        "priority": "medium",
        "subtasks": [
          {
            "id": 1,
            "title": "Drizzle 마이그레이션으로 generalUsers 테이블 스키마 업데이트",
            "description": "Drizzle ORM을 사용하여 `generalUsers` 테이블의 스키마를 업데이트합니다. `name`, `phoneNumber`, `birthDate`, `school`, `personalInfoConsent` 필드를 추가하고, 기존의 `pin` 필드를 제거합니다.",
            "dependencies": [],
            "details": "`lib/db/schema.ts` 파일을 수정하여 `generalUsers` 테이블 정의에 새로운 필드들을 추가하고 `pin` 필드를 제거합니다. 이후 `drizzle-kit generate` 명령어를 사용하여 마이그레이션 파일을 생성하고, `drizzle-kit migrate`를 실행하여 데이터베이스 스키마를 업데이트합니다. 추가되는 필드들의 타입과 제약조건(예: `nullable`, `default`)을 명확히 정의합니다.",
            "status": "done",
            "testStrategy": "Drizzle-kit 스튜디오를 통해 `generalUsers` 테이블의 스키마가 의도한 대로 변경되었는지 확인합니다. 새로운 필드들이 추가되고 `pin` 필드가 제거되었는지 검증합니다. 더미 데이터를 삽입하여 새로운 필드에 대한 데이터 저장 및 조회가 정상 작동하는지 확인합니다."
          },
          {
            "id": 2,
            "title": "회원가입 UI에 신규 필드 반영",
            "description": "회원가입 UI에 `name`, `phoneNumber`, `birthDate`, `school` 입력 필드와 `personalInfoConsent` 동의 체크박스를 추가합니다. 사용자 경험을 고려하여 적절한 UI 컴포넌트를 사용하고 유효성 검사 로직을 구현합니다.",
            "dependencies": [1],
            "details": "회원가입 페이지 컴포넌트(예: `/app/signup/page.tsx`)를 수정하여 사용자가 `name`, `phoneNumber`, `birthDate`, `school` 정보를 입력할 수 있는 폼 필드를 추가합니다. `personalInfoConsent`는 개인정보 수집 및 이용 동의를 위한 체크박스로 구현합니다. 각 필드에 대한 클라이언트 측 유효성 검사(예: 필수 필드, 전화번호 형식 등)를 추가하고, shadcn/ui 컴포넌트를 활용하여 일관된 디자인을 유지합니다.",
            "status": "done",
            "testStrategy": "브라우저에서 회원가입 페이지에 접속하여 모든 신규 필드들이 정상적으로 렌더링되는지 확인합니다. 각 필드에 데이터를 입력하여 UI 유효성 검사가 올바르게 동작하는지 테스트합니다. `personalInfoConsent` 체크박스를 선택/해제했을 때 UI 상태가 올바르게 변경되는지 확인합니다."
          },
          {
            "id": 3,
            "title": "회원가입 서버 액션 로직 업데이트",
            "description": "새로운 회원가입 필드들을 처리하도록 서버 액션 로직을 수정합니다. 전송된 데이터를 검증하고, `users` 테이블에 새 필드들을 포함하여 저장하며, `pin` 필드 관련 로직을 제거합니다.",
            "dependencies": [1, 2],
            "details": "회원가입을 처리하는 서버 액션(예: `lib/actions/auth.ts`의 `signup` 함수)을 수정합니다. UI에서 전송된 `name`, `phoneNumber`, `birthDate`, `school`, `personalInfoConsent` 데이터를 안전하게 수신하고 서버 측 유효성 검사를 수행합니다. Drizzle ORM을 사용하여 `users` 테이블에 새로운 필드들을 포함하여 사용자 데이터를 삽입하도록 쿼리 로직을 업데이트합니다. 기존에 `pin` 필드를 처리하던 모든 로직(데이터 추출, 저장, 검증 등)을 제거합니다.",
            "status": "done",
            "testStrategy": "UI를 통해 새로운 필드들을 포함하여 회원가입을 시도합니다. 성공적인 회원가입 후 데이터베이스에 해당 사용자의 `name`, `phoneNumber`, `birthDate`, `school`, `personalInfoConsent` 값이 올바르게 저장되었는지 확인합니다. 유효하지 않은 데이터를 입력했을 때 서버 측 유효성 검사가 적절한 에러 메시지를 반환하는지 테스트합니다. `pin` 필드에 대한 어떠한 데이터도 저장되지 않는지 확인합니다."
          }
        ]
      },
      {
        "id": 12,
        "title": "키오스크 사용자 식별 방식 변경 및 신규 사용자 등록 플로우 구현",
        "description": "키오스크 대여 프로세스에서 PIN 번호 대신 이름과 생년월일로 사용자를 식별하도록 변경합니다. 존재하지 않는 사용자일 경우, 키오스크에서 바로 신규 등록(전화번호, 학교, 개인정보 동의 포함)을 진행하는 UI와 로직을 구현합니다.",
        "details": "",
        "testStrategy": "",
        "status": "done",
        "dependencies": [11],
        "priority": "medium",
        "subtasks": [
          {
            "id": 1,
            "title": "키오스크 사용자 식별 백엔드 로직 구현 (이름/생년월일)",
            "description": "기존 PIN 번호 기반의 사용자 식별 로직을 이름과 생년월일을 기반으로 사용자를 조회하도록 백엔드 API 및 서비스 로직을 수정합니다. Task 11에서 정의된 사용자 관련 데이터 필드(이름, 생년월일)를 활용합니다.",
            "dependencies": [11],
            "details": "`generalUsers` 테이블에서 이름과 생년월일을 기준으로 사용자를 조회하는 Drizzle ORM 쿼리를 작성하고, 해당 API 엔드포인트(`/api/kiosk/identify-user` 등)를 구현합니다. 조회 결과에 따라 사용자 존재 여부 및 사용자 ID를 반환해야 합니다.",
            "status": "done",
            "testStrategy": "이름과 생년월일로 기존 사용자를 조회하는 API 엔드포인트 테스트를 수행하여 성공 및 실패 케이스를 검증합니다. 유효한 정보로 조회 시 사용자 ID를 반환하고, 유효하지 않거나 존재하지 않는 정보로 조회 시 적절한 오류 또는 '사용자 없음' 응답을 반환하는지 확인합니다."
          },
          {
            "id": 2,
            "title": "키오스크 사용자 식별 입력 UI 개발",
            "description": "키오스크 화면에 사용자 이름과 생년월일(YYYYMMDD 형식)을 입력받는 UI를 구현하고, 입력된 정보로 백엔드 식별 API를 호출하는 기능을 개발합니다. shadcn/ui 컴포넌트를 활용합니다.",
            "dependencies": [],
            "details": "shadcn/ui 컴포넌트를 활용하여 사용자 이름 입력 필드, 생년월일 입력 필드(마스킹 또는 숫자 전용 입력), '확인' 버튼을 디자인합니다. 입력 유효성 검사(예: 생년월일 형식)를 포함하고, 백엔드 식별 API 호출 및 응답에 따른 UI 상태(예: 로딩, 성공 메시지, 오류 메시지, 신규 등록 유도)를 업데이트하는 로직을 구현합니다.",
            "status": "done",
            "testStrategy": "키오스크 UI에서 이름과 생년월일을 입력하여 사용자 식별 API가 올바르게 호출되는지, 그리고 성공/실패 응답에 따라 UI가 적절히 변경되는지 시각적으로 확인합니다. 입력 유효성 검사가 정상 작동하는지 테스트합니다."
          },
          {
            "id": 3,
            "title": "키오스크 신규 사용자 등록 UI 및 백엔드 API 구현",
            "description": "사용자가 존재하지 않을 경우, 키오스크에서 전화번호, 학교 선택, 개인정보 동의를 받아 신규 사용자를 등록하는 UI와 이를 처리할 백엔드 API를 구현합니다.",
            "dependencies": [1],
            "details": "신규 등록 화면 UI(전화번호 입력 필드, 학교 선택 드롭다운, 개인정보 동의 체크박스 및 '등록' 버튼 포함)를 개발하고, 각 필드에 대한 유효성 검사를 추가합니다. 백엔드에는 `/api/kiosk/register-user`와 같은 새로운 사용자 등록 API 엔드포인트를 구현하여 Drizzle ORM을 통해 `users` 테이블에 새 사용자를 추가합니다. (Task 11에서 정의된 학교 정보를 활용).",
            "status": "done",
            "testStrategy": "키오스크 UI를 통해 신규 사용자 등록을 시도하고, 성공적으로 등록된 사용자가 데이터베이스에 추가되는지 확인합니다. 필수 필드 누락, 잘못된 형식 등 유효성 검사 시나리오에 대한 오류 처리가 되는지 검증합니다. 등록 후 사용자 식별이 가능한지 확인합니다."
          },
          {
            "id": 4,
            "title": "사용자 식별/등록 플로우 및 라면 대여 통합",
            "description": "구현된 사용자 식별 및 신규 사용자 등록 플로우를 기존 라면 대여 프로세스에 매끄럽게 연결하고, 전체 키오스크 대여 여정의 UI 흐름을 완성합니다.",
            "dependencies": [1, 2, 3],
            "details": "사용자 식별 성공 시 라면 선택 및 대여 화면으로 이동, 식별 실패 시 신규 등록 화면으로 이동 로직을 구현합니다. 신규 등록 완료 후 자동으로 해당 사용자로 로그인(식별)되거나, 라면 선택/대여 화면으로 전환되는 흐름을 만듭니다. 전체 대여 프로세스 중 사용자 식별/등록 단계의 사용자 경험(UX)을 개선하고, 오류 처리 및 진행 가이드 메시지를 추가합니다.",
            "status": "done",
            "testStrategy": "키오스크에서 처음부터 끝까지 라면 대여 과정을 시뮬레이션합니다. 기존 사용자 식별 성공 후 대여, 신규 사용자 등록 후 대여, 그리고 중간에 발생할 수 있는 오류 상황에 대한 UI/UX 흐름과 백엔드 연동이 문제없이 작동하는지 엔드-투-엔드 테스트를 수행합니다."
          }
        ]
      },
      {
        "id": 13,
        "title": "라면 대여 완료 확인 메시지 추가",
        "description": "사용자가 라면 대여를 성공적으로 마친 후, '대여가 완료되었습니다'와 같은 확인 토스트/메시지를 표시합니다.",
        "details": "",
        "testStrategy": "",
        "status": "done",
        "dependencies": [8, 12],
        "priority": "medium",
        "subtasks": [
          {
            "id": 1,
            "title": "라면 대여 완료 토스트/메시지 구현",
            "description": "사용자가 라면 대여를 성공적으로 완료했을 때, '대여가 완료되었습니다!'와 같은 확인 메시지를 토스트 또는 다른 UI 메시지 컴포넌트를 사용하여 화면에 표시합니다. shadcn/ui의 Toast 컴포넌트를 활용하거나, `react-hot-toast`와 같은 라이브러리를 사용하여 구현합니다.",
            "dependencies": [8, 2],
            "details": "라면 대여 API 호출이 성공적으로 완료된 후, 클라이언트 측에서 `toast.success('대여가 완료되었습니다!')`와 같은 메시지를 트리거하도록 구현합니다. `shadcn/ui`의 Toast 컴포넌트(또는 `react-hot-toast`)를 사용하여 사용자에게 시각적인 피드백을 제공합니다. 메시지는 몇 초 후 자동으로 사라지도록 설정합니다.",
            "status": "done",
            "testStrategy": "라면 대여 기능을 실행하여 대여가 성공적으로 처리될 때 '대여가 완료되었습니다!' 메시지가 화면에 올바르게 표시되는지 확인합니다. 메시지의 내용, 스타일, 그리고 자동 소멸 기능이 정상적으로 작동하는지 검증합니다."
          }
        ]
      },
      {
        "id": 14,
        "title": "라면 테이블 스키마 수정",
        "description": "라면 테이블에 새로운 필드를 추가하거나 기존 필드를 수정합니다.",
        "details": "PRD에 따라 라면 테이블 스키마를 업데이트합니다. 예를 들어, 'ramens' 테이블에 'category' 필드를 추가하거나 'description' 필드를 수정할 수 있습니다. 이 변경은 Drizzle ORM 마이그레이션을 통해 이루어져야 합니다.",
        "testStrategy": "Drizzle 마이그레이션을 실행하고 스키마 변경 사항이 데이터베이스에 올바르게 반영되었는지 확인합니다. 새로운 필드에 더미 데이터를 삽입하고 조회하여 정상 작동하는지 검증합니다.",
        "priority": "high",
        "dependencies": [1],
        "status": "done",
        "subtasks": []
      },
      {
        "id": 15,
        "title": "키오스크 대여 완료 후 모달 띄우기 (7초 타임아웃)",
        "description": "라면 대여 완료 후 사용자에게 확인 모달을 7초간 표시합니다.",
        "details": "대여 성공 시 `shadcn/ui`의 `Dialog` 컴포넌트를 사용하여 모달을 띄우고, '대여가 완료되었습니다!' 메시지와 함께 7초 후 자동으로 닫히도록 구현합니다. 이 모달은 `app/(kiosk)/page.tsx` 또는 관련 컴포넌트에서 렌더링되어야 합니다.",
        "testStrategy": "라면 대여 기능을 실행하여 대여가 성공적으로 처리될 때 확인 모달이 올바르게 표시되고, 7초 후 자동으로 사라지는지 확인합니다. 모달의 내용과 스타일이 예상대로인지 검증합니다.",
        "priority": "medium",
        "dependencies": [8, 13],
        "status": "done",
        "subtasks": []
      },
      {
        "id": 16,
        "title": "관리자 페이지에 닌텐도 및 활동 관련 섹션 추가",
        "description": "관리자 페이지에 닌텐도 및 기타 활동 관리를 위한 새로운 섹션을 추가합니다.",
        "details": "관리자 대시보드에 '닌텐도 관리' 및 '활동 관리' 메뉴 항목을 추가합니다. 각각 `/admin/nintendo` 및 `/admin/activities`와 같은 새로운 관리자 페이지를 생성하고, 각 섹션에 대한 CRUD(생성, 읽기, 업데이트, 삭제) 기능을 구현합니다. 이 기능은 새로운 데이터베이스 스키마 정의(예: `nintendo`, `activities` 테이블)와 서버 액션/API를 포함해야 합니다.",
        "testStrategy": "관리자 계정으로 로그인하여 새로운 '닌텐도 관리' 및 '활동 관리' 섹션에 접근하고, 각 섹션의 UI가 올바르게 렌더링되는지 확인합니다. 각 섹션의 CRUD 기능이 데이터베이스와 연동되어 정상 작동하는지 테스트합니다.",
        "priority": "medium",
        "dependencies": [5],
        "status": "done",
        "subtasks": []
      },
      {
        "id": 17,
        "title": "관리자 페이지에 대여 기록 Excel 내보내기 기능 구현",
        "description": "관리자 대여 기록 페이지(`/admin/records`)에서 현재 필터링된 대여 기록을 Excel 파일로 내보내는 기능을 구현합니다.",
        "details": "",
        "testStrategy": "",
        "status": "done",
        "dependencies": [9],
        "priority": "medium",
        "subtasks": [
          {
            "id": 1,
            "title": "관리자 대여 기록 페이지에 Excel 내보내기 버튼 추가",
            "description": "관리자 대여 기록 페이지(`/admin/records`)에 'Excel 내보내기' 버튼 UI 요소를 추가하고, 이 버튼 클릭 시 서버의 Excel 내보내기 API 엔드포인트를 호출하도록 클라이언트 측 로직을 구현합니다.",
            "dependencies": [],
            "details": "`admin/records` 페이지 컴포넌트에 shadcn/ui의 Button 컴포넌트를 활용하여 Excel 내보내기 버튼을 추가합니다. 버튼 클릭 시 `/api/admin/records/export`와 같은 서버 액션 또는 API 엔드포인트를 호출하는 클라이언트 측 함수를 작성합니다.",
            "status": "done",
            "testStrategy": "관리자 대여 기록 페이지에 접속하여 Excel 내보내기 버튼이 올바르게 렌더링되고 시각적으로 문제가 없는지 확인합니다. 개발자 도구를 통해 버튼 클릭 시 API 호출이 정상적으로 시작되는지 검증합니다."
          },
          {
            "id": 2,
            "title": "필터링된 대여 기록 기반 Excel 파일 생성 서버 액션 구현",
            "description": "서버 측에 `/api/admin/records/export` 엔드포인트를 구현하여 현재 필터링된 대여 기록 데이터를 조회하고, 조회된 데이터를 기반으로 Excel 파일을 생성하는 로직을 개발합니다.",
            "dependencies": [],
            "details": "Drizzle ORM을 사용하여 데이터베이스에서 필터링 조건(쿼리 파라미터로 전달된)에 맞는 대여 기록을 조회합니다. `exceljs` 또는 유사한 라이브러리를 활용하여 조회된 데이터를 Excel 워크북 형태로 변환하고, 적절한 헤더와 셀 서식을 적용합니다. 생성된 Excel 파일을 버퍼 형태로 HTTP 응답 본문에 담아 클라이언트에 전송할 준비를 합니다.",
            "status": "done",
            "testStrategy": "Postman이나 Insomnia와 같은 API 테스트 도구를 사용하여 `/api/admin/records/export` 엔드포인트에 필터링 파라미터와 함께 요청을 보냅니다. 응답으로 유효한 Excel 파일이 다운로드되는지 확인하고, 파일 내용을 열어 데이터의 정확성과 형식이 올바른지 검증합니다."
          },
          {
            "id": 3,
            "title": "클라이언트 측 Excel 파일 다운로드 처리 구현",
            "description": "서버에서 생성된 Excel 파일 응답을 성공적으로 수신하여 사용자의 웹 브라우저에서 해당 파일을 다운로드하도록 처리하는 클라이언트 측 로직을 구현합니다.",
            "dependencies": [1, 2],
            "details": "서버 액션으로부터 `Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet` 및 `Content-Disposition` 헤더와 함께 전송되는 Excel 파일 데이터(BLOB)를 처리합니다. JavaScript의 `Blob` 객체와 `URL.createObjectURL`을 사용하여 임시 URL을 생성하고, 가상의 `<a>` 태그를 생성하여 `download` 속성과 `href` 속성을 설정한 후 클릭 이벤트로 파일 다운로드를 시작합니다. 다운로드 완료 후 `URL.revokeObjectURL`을 호출하여 임시 URL을 해제합니다.",
            "status": "done",
            "testStrategy": "관리자 페이지에서 Excel 내보내기 버튼을 클릭하여 Excel 파일이 정상적으로 다운로드되는지 확인합니다. 다운로드된 파일의 이름이 올바른지, 파일이 손상되지 않고 문제없이 열리는지 확인합니다."
          }
        ]
      },
      {
        "id": 18,
        "title": "복지시설 물품 대여 현황 대시보드 개발",
        "description": "범용 물품 대여 키오스크의 운영 현황을 관리자가 직관적으로 파악하고, 데이터에 기반한 결정을 내릴 수 있도록 통계 대시보드를 개발합니다. '아동, 청소년, 성인' 그룹별 분석과 '품목 카테고리' 분석을 핵심 기능으로 제공합니다.",
        "status": "done",
        "dependencies": [9],
        "priority": "high",
        "details": "이 과제는 변경된 `drizzle/schema.ts`를 기반으로, 대여 기록(`rentalRecords`)을 `general_users` 및 `items` 테이블과 결합하여 실질적인 운영 인사이트를 제공하는 것을 목표로 합니다.\n\n**핵심 목표:**\n- **데이터 기반 품목 관리:** 인기/비인기 품목 및 카테고리 분석을 통해 재고를 최적화하고 예산을 효율적으로 사용합니다.\n- **이용자 그룹 이해:** '아동, 청소년, 성인' 그룹별 선호도를 파악하여 모든 이용자의 만족도를 높입니다.\n- **운영 성과 측정:** '총 서비스 이용 인원' 등 핵심 지표를 통해 프로그램의 실질적인 기여도를 측정하고 보고합니다.\n\n**수정 대상 파일:**\n- `lib/actions/rental-actions.ts`: 데이터 집계 로직을 포함하는 서버 액션 파일.\n- `lib/types/analytics.ts`: 대시보드 데이터 타입을 정의하는 파일.\n\n**참조 파일:**\n- `drizzle/schema.ts`: `rentalRecords`, `general_users`, `items` 테이블 간의 관계 확인.\n- `src/app/(admin)/admin/RentalAnalyticsClient.tsx`: UI 구현 참조.\n\n**연령 그룹 기준:**\n- 아동: 0-12세\n- 청소년: 13-18세\n- 성인: 19세 이상",
        "testStrategy": "서버 액션 함수가 '아동, 청소년, 성인' 그룹과 '품목 카테고리'를 정확히 구분하여 데이터를 집계하는지 검증합니다. 더미 데이터를 활용하여 각 그룹 및 카테고리별 대여 기록이 있을 때와 없을 때, 다양한 필터 조합(연도/월/연령그룹/카테고리) 시나리오에서 대시보드가 예상대로 동작하는지 종합적으로 테스트합니다.",
        "subtasks": [
          {
            "id": 1,
            "title": "대시보드 데이터 타입(AnalyticsData) 정의",
            "description": "서버와 클라이언트 간의 데이터 계약을 확립하기 위해, 대시보드에 필요한 모든 통계 데이터를 포함하는 `AnalyticsData` 타입을 `lib/types/analytics.ts` 파일에 정의합니다.",
            "dependencies": [],
            "details": "`lib/types` 디렉토리가 없다면 생성하고, `analytics.ts` 파일을 추가합니다.\n\n타입에 포함될 주요 데이터 구조:\n- **핵심 KPI**: 총 대여 건수, 총 고유 이용자 수, 가장 인기 있는 품목, 가장 인기 있는 카테고리\n- **연령 그룹별 통계**: 각 그룹(아동/청소년/성인)별 대여 건수, 고유 이용자 수, 비중\n- **카테고리별 통계**: 각 카테고리별 대여 건수, 비중, 인기 품목\n- **품목별 통계**: 인기 품목 TOP 10, 비인기 품목 리스트\n- **시간대별 통계**: 시간대별 대여 건수 (선택적)\n- **요일별 통계**: 요일별 대여 건수 (선택적)\n\n`src/app/(admin)/admin/RentalAnalyticsClient.tsx` 파일을 참조하여 UI에서 필요로 하는 모든 데이터 필드를 누락 없이 포함시킵니다.",
            "status": "done",
            "testStrategy": "정의된 `AnalyticsData` 타입이 기획된 대시보드의 모든 요구사항을 충족하는지 코드 리뷰를 통해 검증합니다. 클라이언트 컴포넌트에서 해당 타입을 성공적으로 import하고 사용할 수 있는지 TypeScript 컴파일 오류 없이 확인합니다."
          },
          {
            "id": 2,
            "title": "이용자 그룹별 대여 통계 집계 함수 구현",
            "description": "`lib/actions/rental-actions.ts` 파일에 `rentalRecords`와 `general_users` 테이블을 조인하여 '아동', '청소년', '성인' 그룹별 대여 횟수, 고유 이용자 수 등을 집계하는 내부 헬퍼 함수 `getAgeGroupStats`를 구현합니다.",
            "dependencies": [1],
            "details": "**함수 시그니처:** `async function getAgeGroupStats(filters: { year: string, month: string | 'all', ageGroup?: string })`\n\n**구현 내용:**\n- Drizzle ORM을 사용하여 `rentalRecords`와 `general_users`를 조인\n- `general_users` 테이블의 생년월일(`birthDate` 또는 `dateOfBirth`) 필드를 기반으로 대여 시점의 나이를 계산\n- 연령 그룹 분류 로직: 0-12세(아동), 13-18세(청소년), 19세 이상(성인)\n- `filters.year`와 `filters.month`를 사용하여 `rental_date` 필터링\n- `filters.ageGroup`이 지정되면 해당 그룹만, 없으면 전체 그룹 집계\n- 각 그룹별로: 총 대여 건수, 고유 이용자 수(`userId`의 DISTINCT COUNT), 전체 대비 비중 계산\n- `peopleCount` 필드가 1 이상인 경우, 해당 값을 대여 건수에 반영할지 결정 (기획 확인 필요)\n\n**반환 형태:**\n```typescript\n{\n  child: { count: number, uniqueUsers: number, percentage: number },\n  teen: { count: number, uniqueUsers: number, percentage: number },\n  adult: { count: number, uniqueUsers: number, percentage: number }\n}\n```",
            "status": "done",
            "testStrategy": "더미 데이터를 삽입하여 각 연령 그룹에 해당하는 사용자가 대여 기록을 가질 때, 함수가 정확한 그룹별 대여 횟수 및 이용자 수를 반환하는지 단위 테스트를 통해 검증합니다. 특정 그룹에 데이터가 없는 경우, 해당 그룹의 값이 0으로 반환되는지 확인합니다. 연도/월 필터가 올바르게 적용되는지도 테스트합니다."
          },
          {
            "id": 3,
            "title": "품목 카테고리별 대여 통계 집계 함수 구현",
            "description": "`lib/actions/rental-actions.ts` 파일에 `rentalRecords`와 `items` 테이블을 조인하여 품목 카테고리별 대여 횟수, 각 카테고리 내 인기 품목 등의 통계를 집계하는 내부 헬퍼 함수 `getCategoryStats`를 구현합니다.",
            "dependencies": [1],
            "details": "**함수 시그니처:** `async function getCategoryStats(filters: { year: string, month: string | 'all', category?: string, ageGroup?: string })`\n\n**구현 내용:**\n- Drizzle ORM을 사용하여 `rentalRecords`, `items`, 필요시 `general_users` 테이블 조인\n- `items` 테이블의 `category` 필드를 기준으로 그룹화\n- `filters.category`가 지정되면 해당 카테고리만, 없으면 전체 카테고리 집계\n- `filters.ageGroup`이 지정되면 해당 연령 그룹의 대여 기록만 집계\n- 각 카테고리별로: 총 대여 건수, 전체 대비 비중, 해당 카테고리 내 가장 인기 있는 품목 TOP 3\n- `items` 테이블의 품목명(`name`), 품목 ID 등 필요한 정보 포함\n\n**반환 형태:**\n```typescript\n[\n  {\n    category: string,\n    totalRentals: number,\n    percentage: number,\n    topItems: [{ itemId: number, itemName: string, rentals: number }, ...]\n  },\n  ...\n]\n```",
            "status": "done",
            "testStrategy": "다양한 카테고리와 품목의 더미 대여 기록을 생성한 후, 함수가 카테고리별 총 대여 횟수와 인기 품목을 정확하게 식별하는지 단위 테스트를 수행합니다. 카테고리에 대여 기록이 없는 경우, 해당 카테고리가 결과에서 제외되는지 확인합니다. 필터 조합(연도/월/카테고리/연령그룹)이 정확히 적용되는지 검증합니다."
          },
          {
            "id": 4,
            "title": "전체 핵심 지표 집계 함수 구현",
            "description": "`lib/actions/rental-actions.ts` 파일에 전체 서비스의 총 대여 건수, 총 고유 이용자 수, 가장 인기 있는 품목/카테고리 등 핵심 KPI를 집계하는 내부 헬퍼 함수 `getOverallKPIs`를 구현합니다.",
            "dependencies": [1],
            "details": "**함수 시그니처:** `async function getOverallKPIs(filters: { year: string, month: string | 'all', ageGroup?: string, category?: string })`\n\n**구현 내용:**\n- 필터 조건에 맞는 `rentalRecords` 조회\n- 총 대여 건수 계산 (COUNT)\n- 총 고유 이용자 수 계산 (DISTINCT COUNT of `userId`)\n- 가장 많이 대여된 품목 식별 (`items` 테이블과 조인)\n- 가장 인기 있는 카테고리 식별\n- 평균 대여 시간, 반납률 등 추가 지표 (선택적, 데이터 가용성에 따라)\n\n**반환 형태:**\n```typescript\n{\n  totalRentals: number,\n  uniqueUsers: number,\n  mostPopularItem: { id: number, name: string, rentals: number },\n  mostPopularCategory: { name: string, rentals: number }\n}\n```",
            "status": "done",
            "testStrategy": "더미 대여 기록이 있는 경우와 없는 경우, 그리고 동일한 사용자가 여러 번 대여한 경우를 포함한 시나리오에서 함수가 총 대여 건수와 고유 이용자 수를 정확하게 집계하는지 단위 테스트를 통해 검증합니다. 필터를 조합했을 때도 올바른 KPI가 계산되는지 확인합니다."
          },
          {
            "id": 5,
            "title": "품목별 상세 통계 집계 함수 구현",
            "description": "인기 품목 TOP 10과 비인기 품목(대여 횟수 하위 또는 미대여 품목) 리스트를 반환하는 내부 헬퍼 함수 `getItemStats`를 구현합니다.",
            "dependencies": [1],
            "details": "**함수 시그니처:** `async function getItemStats(filters: { year: string, month: string | 'all', ageGroup?: string, category?: string })`\n\n**구현 내용:**\n- `rentalRecords`와 `items` 조인하여 각 품목별 대여 횟수 집계\n- 필터 조건 적용 (연도/월/연령그룹/카테고리)\n- 대여 횟수 기준 내림차순 정렬하여 TOP 10 추출\n- 대여 횟수가 0이거나 설정된 임계값(예: 5회) 미만인 품목을 비인기 품목으로 분류\n- 각 품목의 기본 정보(ID, 이름, 카테고리, 대여 가능 여부 등) 포함\n\n**반환 형태:**\n```typescript\n{\n  topItems: [{ id: number, name: string, category: string, rentals: number }, ...],\n  unpopularItems: [{ id: number, name: string, category: string, rentals: number }, ...]\n}\n```",
            "status": "done",
            "testStrategy": "다양한 대여 빈도를 가진 품목 데이터로 함수를 테스트하여, 인기 품목과 비인기 품목이 정확히 분류되는지 확인합니다. 필터 조합에 따라 결과가 달라지는지 검증합니다."
          },
          {
            "id": 6,
            "title": "통합 대시보드 데이터 조회 서버 액션 구현 (getRentalAnalytics)",
            "description": "`lib/actions/rental-actions.ts` 파일에 `getRentalAnalytics`라는 이름의 메인 서버 액션 함수를 구현합니다. 이 함수는 앞서 구현된 모든 헬퍼 함수들을 호출하여 데이터를 통합하고, `AnalyticsData` 타입에 맞는 구조로 반환합니다.",
            "dependencies": [1, 2, 3, 4, 5],
            "details": "**함수 시그니처:** `export async function getRentalAnalytics(filters: { year: string, month: string | 'all', ageGroup?: string, category?: string }): Promise<AnalyticsData>`\n\n**구현 내용:**\n- 'use server' 지시자 사용하여 서버 액션으로 선언\n- 입력 파라미터 검증 (year는 필수, month는 'all' 또는 1-12)\n- `Promise.all`을 사용하여 모든 헬퍼 함수를 병렬로 호출:\n  - `getAgeGroupStats(filters)`\n  - `getCategoryStats(filters)`\n  - `getOverallKPIs(filters)`\n  - `getItemStats(filters)`\n- 반환된 모든 데이터를 `AnalyticsData` 타입 구조에 맞게 조합\n- 에러 처리: try-catch로 감싸고, 에러 발생 시 적절한 에러 메시지와 함께 빈 데이터 구조 반환\n- 데이터가 없는 경우(필터 조건에 맞는 대여 기록 없음)에도 기본값으로 채워진 `AnalyticsData` 반환\n\n**월(month) 필터링 로직:**\n- `month === 'all'`: 해당 연도 전체 (1월 1일 ~ 12월 31일)\n- `month === '1'` ~ `'12'`: 해당 월의 1일부터 말일까지\n- Drizzle ORM의 날짜 비교 함수 활용 (예: `gte`, `lte`)",
            "status": "done",
            "testStrategy": "클라이언트에서 `getRentalAnalytics` 서버 액션을 다양한 필터 조합으로 호출했을 때, `AnalyticsData` 타입에 맞는 완전하고 정확한 데이터가 반환되는지 엔드투엔드 테스트를 수행합니다. 모든 집계된 데이터(그룹별, 카테고리별, 핵심 지표, 품목별)가 예상값과 일치하는지 확인하고, 데이터가 없을 때 빈 배열이나 0 등의 기본값이 올바르게 반환되는지도 테스트합니다. 특히 `month: 'all'`과 특정 월 선택 시 데이터 범위가 정확한지 검증합니다."
          },
          {
            "id": 7,
            "title": "대시보드 필터 UI 개발",
            "description": "`RentalAnalyticsClient.tsx`에 연도/월/연령그룹/카테고리 선택을 위한 통합 필터 UI를 개발합니다. shadcn/ui의 `Select` 컴포넌트를 사용합니다.",
            "dependencies": [],
            "details": "**구현 내용:**\n- 페이지 최상단에 필터 섹션 배치\n- **연도 선택**: `Select` 컴포넌트로 구현, 현재 연도부터 과거 5년치 옵션 제공 (예: 2025, 2024, 2023, 2022, 2021)\n- **월 선택**: `Select` 컴포넌트로 구현, '전체', '1월', '2월', ..., '12월' 옵션 제공\n- **연령 그룹 선택**: `Select` 컴포넌트로 구현, '전체', '아동', '청소년', '성인' 옵션 제공\n- **카테고리 선택**: `Select` 컴포넌트로 구현, '전체' 옵션과 함께 DB에서 가져온 카테고리 목록 표시 (동적으로 로드)\n- React state(`useState`)로 각 필터 값 관리\n- 필터 값이 변경될 때마다 `useEffect`를 통해 서버 액션 호출하여 데이터 갱신\n- 로딩 상태 표시 (Skeleton 또는 Spinner)\n- 반응형 디자인: 모바일에서는 2x2 그리드, 데스크톱에서는 1줄에 4개 필터 배치",
            "status": "done",
            "testStrategy": "UI 컴포넌트가 시각적으로 올바르게 렌더링되는지 확인하고, 각 필터를 변경했을 때 해당 상태값이 올바르게 업데이트되는지 React DevTools를 사용해 확인합니다. 카테고리 선택지가 동적으로 로드되는지도 검증합니다."
          },
          {
            "id": 8,
            "title": "핵심 성과 지표(KPI) 카드 UI 개발",
            "description": "필터 아래에 총 대여 건수, 총 이용자 수, 인기 품목, 인기 카테고리 등 핵심 지표를 보여주는 KPI 카드 섹션을 개발합니다.",
            "dependencies": [6, 7],
            "details": "**구현 내용:**\n- shadcn/ui의 `Card` 컴포넌트 사용\n- 4개의 KPI 카드를 그리드 레이아웃으로 배치 (2x2 또는 1x4)\n- 각 카드 구성:\n  - 상단: 지표명 (예: '총 대여 건수')\n  - 중앙: 큰 폰트로 숫자 표시\n  - 하단: 전월/전년 대비 증감률 표시 (선택적, 추후 구현 가능)\n- 아이콘 추가 (lucide-react 사용): 대여 건수(📦), 이용자 수(👥), 인기 품목(⭐), 인기 카테고리(📊)\n- 데이터 로딩 중일 때 Skeleton 표시\n- 애니메이션 효과: 숫자가 카운트업되는 효과 (선택적)\n\n**표시할 지표:**\n1. 총 대여 건수\n2. 총 고유 이용자 수\n3. 가장 인기 있는 품목명 + 대여 횟수\n4. 가장 인기 있는 카테고리명 + 대여 횟수",
            "status": "done",
            "testStrategy": "필터를 변경했을 때 KPI 카드의 값들이 실시간으로 업데이트되는지 확인합니다. 데이터가 없는 경우 '데이터 없음' 또는 '0' 등 적절한 표시가 되는지 검증합니다."
          },
          {
            "id": 9,
            "title": "연령 그룹별 통계 차트 시각화",
            "description": "아동, 청소년, 성인 그룹별 대여 비중과 통계를 Recharts를 사용하여 시각화합니다.",
            "dependencies": [6, 7],
            "details": "**구현 내용:**\n- Recharts의 `PieChart` 또는 `BarChart` 사용\n- 섹션 제목: '연령 그룹별 대여 현황'\n- 차트 타입:\n  - Pie Chart: 각 그룹의 대여 비중을 원형 차트로 표시\n  - Bar Chart: 그룹별 대여 건수 및 고유 이용자 수를 막대 차트로 표시\n- 범례 표시, 색상 구분 (아동: 파랑, 청소년: 초록, 성인: 주황)\n- 차트 옆 또는 아래에 테이블 형식으로 상세 수치 표시:\n  - 그룹명 | 대여 건수 | 이용자 수 | 비중(%)\n- 반응형: 모바일에서는 차트와 테이블을 세로로 배치\n- 툴팁 기능: 차트 요소에 마우스 오버 시 상세 정보 표시",
            "status": "done",
            "testStrategy": "필터를 변경했을 때 차트가 정확한 데이터를 반영하는지 확인합니다. 특정 연령 그룹의 데이터가 0인 경우에도 차트가 깨지지 않고 올바르게 표시되는지 검증합니다."
          },
          {
            "id": 10,
            "title": "카테고리별 통계 차트 및 테이블 시각화",
            "description": "품목 카테고리별 대여 현황을 차트와 테이블로 시각화합니다.",
            "dependencies": [6, 7],
            "details": "**구현 내용:**\n- 섹션 제목: '카테고리별 대여 현황'\n- **차트 부분**:\n  - Recharts의 `BarChart` 또는 `PieChart` 사용\n  - 각 카테고리의 대여 건수 또는 비중을 시각화\n- **테이블 부분**:\n  - shadcn/ui의 `Table` 컴포넌트 사용\n  - 컬럼: 카테고리명 | 대여 건수 | 비중(%) | 인기 품목 TOP 3\n  - 대여 건수 기준 내림차순 정렬\n  - 페이지네이션 또는 스크롤 (카테고리가 많을 경우)\n- 인기 품목은 품목명만 표시하거나, 클릭 시 상세 정보 모달 표시 (선택적)\n- 빈 카테고리(대여 기록 없음)는 테이블 하단에 별도 표시 또는 제외",
            "status": "done",
            "testStrategy": "필터 조합을 변경했을 때 카테고리별 통계가 정확히 업데이트되는지 확인합니다. 카테고리 필터를 특정 카테고리로 선택했을 때 해당 카테고리만 표시되는지 검증합니다."
          },
          {
            "id": 11,
            "title": "인기/비인기 품목 테이블 UI 개발",
            "description": "가장 많이/적게 대여된 품목들을 테이블 형식으로 표시합니다.",
            "dependencies": [6, 7],
            "details": "**구현 내용:**\n- 두 개의 테이블 섹션으로 구분:\n  1. '인기 품목 TOP 10'\n  2. '비인기 품목' (대여 횟수 하위 또는 미대여)\n- shadcn/ui의 `Table` 컴포넌트 사용\n- **인기 품목 테이블 컬럼**:\n  - 순위 | 품목명 | 카테고리 | 대여 횟수 | 비고\n- **비인기 품목 테이블 컬럼**:\n  - 품목명 | 카테고리 | 대여 횟수 | 권장 조치 (예: '홍보 필요', '재고 검토')\n- 순위는 배지 또는 메달 아이콘으로 표시 (1위: 🥇, 2위: 🥈, 3위: 🥉)\n- 비인기 품목이 많을 경우 접기/펼치기 기능 추가\n- 각 품목 행 클릭 시 해당 품목의 상세 대여 이력 모달 표시 (선택적)",
            "status": "done",
            "testStrategy": "필터를 변경했을 때 인기/비인기 품목이 정확히 업데이트되는지 확인합니다. 대여 기록이 전혀 없는 품목이 비인기 품목 테이블에 올바르게 표시되는지 검증합니다."
          },
          {
            "id": 12,
            "title": "시간대별/요일별 대여 현황 차트 구현",
            "description": "대여가 가장 활발한 시간대와 요일을 분석하여 차트로 시각화합니다. 이는 운영 시간 최적화에 활용될 수 있습니다.",
            "dependencies": [6, 7],
            "details": "**구현 내용:**\n- `rentalRecords` 테이블의 `rental_date` 필드에서 시간대(0-23시)와 요일 정보 추출\n- **시간대별 차트**:\n  - Recharts의 `LineChart` 또는 `AreaChart` 사용\n  - X축: 시간대 (0시~23시), Y축: 대여 건수\n  - 피크 시간대 강조 표시\n- **요일별 차트**:\n  - Recharts의 `BarChart` 사용\n  - X축: 요일 (월~일), Y축: 대여 건수\n  - 가장 바쁜 요일 색상 강조\n- 두 차트를 그리드로 나란히 배치 (데스크톱) 또는 세로로 배치 (모바일)\n- 필터 조건에 따라 데이터 변경\n\n**추가 헬퍼 함수 필요:**\n- `lib/actions/rental-actions.ts`에 `getTimePatternStats(filters)` 함수 추가\n- 시간대별/요일별 집계 쿼리 작성",
            "status": "done",
            "testStrategy": "다양한 시간대와 요일에 분산된 더미 데이터로 차트가 정확하게 렌더링되는지 확인합니다. 특정 시간대나 요일에 데이터가 없어도 차트가 깨지지 않는지 검증합니다."
          },
          {
            "id": 13,
            "title": "대시보드 전체 통합 및 최적화",
            "description": "모든 UI 컴포넌트를 `RentalAnalyticsClient.tsx`에 통합하고, 성능 최적화 및 에러 처리를 구현합니다.",
            "dependencies": [7, 8, 9, 10, 11],
            "details": "**구현 내용:**\n- 모든 서브 컴포넌트를 `RentalAnalyticsClient.tsx`에 조립\n- 레이아웃 구조:\n  1. 필터 섹션 (상단 고정 가능)\n  2. KPI 카드 그리드\n  3. 연령 그룹별 차트\n  4. 카테고리별 차트 및 테이블\n  5. 인기/비인기 품목 테이블\n  6. 시간대/요일별 차트 (선택적)\n- **성능 최적화**:\n  - React.memo()를 사용하여 불필요한 리렌더링 방지\n  - useMemo()로 복잡한 계산 결과 캐싱\n  - 필터 변경 시 debounce 적용 (너무 빠른 연속 호출 방지)\n- **에러 처리**:\n  - 서버 액션 호출 실패 시 에러 메시지 표시\n  - Toast 알림 또는 에러 배너 사용\n  - 재시도 버튼 제공\n- **로딩 상태**:\n  - 전체 대시보드 로딩 시 Skeleton UI 표시\n  - 각 섹션별 로딩 표시기 (선택적)\n- **빈 데이터 처리**:\n  - 필터 조건에 맞는 데이터가 없을 때 적절한 안내 메시지 표시\n  - '데이터가 없습니다. 다른 필터 조건을 선택해주세요.' 등\n- **접근성**:\n  - 시맨틱 HTML 사용\n  - 키보드 네비게이션 지원\n  - 스크린 리더 지원 (aria-label 등)\n- **반응형 디자인**:\n  - 모바일, 태블릿, 데스크톱에서 모두 최적화된 레이아웃\n  - 작은 화면에서는 차트 크기 조정 및 테이블 스크롤 가능",
            "status": "done",
            "testStrategy": "다양한 필터 조합으로 대시보드를 테스트하여 모든 섹션이 일관성 있게 업데이트되는지 확인합니다. 네트워크가 느린 상황을 시뮬레이션하여 로딩 상태가 올바르게 표시되는지 검증합니다. 에러를 강제로 발생시켜 에러 핸들링이 작동하는지 확인합니다. 모바일, 태블릿, 데스크톱 각 화면 크기에서 UI가 깨지지 않는지 확인합니다. 브라우저 콘솔에 불필요한 리렌더링 경고가 없는지 확인합니다."
          },
          {
            "id": 14,
            "title": "데이터 내보내기 기능 구현 (선택적)",
            "description": "대시보드 데이터를 CSV 또는 Excel 파일로 내보내는 기능을 추가합니다.",
            "dependencies": [13],
            "details": "**구현 내용:**\n- 대시보드 상단 또는 하단에 '데이터 내보내기' 버튼 추가\n- 클릭 시 모달 또는 드롭다운 메뉴 표시:\n  - 내보내기 형식 선택: CSV, Excel (XLSX)\n  - 내보낼 데이터 선택: 전체 / 현재 필터 조건만\n- CSV 내보내기:\n  - 클라이언트 사이드에서 현재 표시된 데이터를 CSV 문자열로 변환\n  - Blob을 생성하여 다운로드 링크 제공\n- Excel 내보내기 (선택적):\n  - 서버 액션을 통해 Excel 파일 생성 (예: exceljs 라이브러리)\n  - 여러 시트: KPI, 연령 그룹별, 카테고리별, 품목별 등\n- 파일명: `대여통계_YYYY-MM-DD.csv` 형식\n- 내보내기 진행 상태 표시 (스피너 또는 프로그레스 바)\n- 완료 후 성공 메시지 토스트 표시",
            "status": "done",
            "testStrategy": "다양한 필터 조건에서 내보내기를 수행하여 파일에 올바른 데이터가 포함되는지 확인합니다. 파일이 올바르게 다운로드되고, Excel/CSV 프로그램에서 정상적으로 열리는지 검증합니다. 대용량 데이터(수천 건)도 정상적으로 내보내기되는지 테스트합니다."
          }
        ]
      },
      {
        "id": 19,
        "title": "Docker 배포 구성 및 최종 테스트",
        "description": "쉬운 배포를 위해 `Dockerfile` 및 `docker-compose.yml`을 작성하고, PWA 매니페스트를 구성하며, 모든 사용자 흐름에 대한 엔드투엔드 테스트를 수행합니다.",
        "details": "Next.js 애플리케이션을 컨테이너화하기 위한 `Dockerfile`을 작성합니다. 데이터베이스 및 애플리케이션 서비스를 오케스트레이션하기 위한 `docker-compose.yml`을 구성합니다. PWA 기능을 위해 `public/manifest.json` 파일을 생성하고 `next.config.js`에 PWA 설정을 추가합니다. 모든 사용자 역할(일반 사용자, 관리자)에 대한 등록, 로그인, 라면 대여, 재고 관리, 기록 보기 등 핵심 사용자 흐름에 대한 엔드투엔드 테스트 시나리오를 작성하고 실행합니다.",
        "testStrategy": "Docker 컨테이너 내에서 애플리케이션을 빌드하고 실행하여 모든 서비스가 올바르게 시작되고 작동하는지 확인합니다. PWA '홈 화면에 추가' 기능이 작동하는지 모바일 장치에서 테스트합니다. 모든 사용자 흐름에 대한 수동 또는 자동화된 엔드투엔드 테스트를 수행하여 기능의 완전성을 검증합니다.",
        "priority": "low",
        "dependencies": [1, 4, 6, 8, 9],
        "status": "done",
        "subtasks": [
          {
            "id": 1,
            "title": "Next.js 애플리케이션용 Dockerfile 작성",
            "description": "Next.js 애플리케이션을 Docker 컨테이너 내에서 빌드하고 실행하기 위한 Dockerfile을 작성합니다.",
            "dependencies": [1, 4],
            "details": "최적화된 Docker 이미지 생성을 위해 멀티스테이지 빌드를 사용하고, 필요한 의존성 설치, 빌드 프로세스, 포트 노출 등을 포함합니다. 프로덕션 환경에 적합한 빌드 아티팩트를 생성하도록 구성합니다.",
            "status": "done",
            "testStrategy": "`docker build -t nextjs-app .` 명령어를 실행하여 이미지가 성공적으로 빌드되는지 확인하고, `docker run -p 3000:3000 nextjs-app`으로 실행하여 애플리케이션이 정상적으로 구동되는지 확인합니다."
          },
          {
            "id": 2,
            "title": "docker-compose.yml을 사용한 애플리케이션 및 SQLite DB 서비스 구성",
            "description": "Next.js 애플리케이션과 SQLite 데이터베이스 서비스를 함께 오케스트레이션하기 위한 docker-compose.yml 파일을 구성합니다.",
            "dependencies": [1, 4],
            "details": "애플리케이션 서비스와 SQLite 데이터베이스 서비스 (볼륨을 사용하여 데이터를 영속화)를 정의하고, 두 서비스 간의 네트워크 및 환경 변수 설정을 구성합니다.",
            "status": "done",
            "testStrategy": "`docker-compose up --build` 명령어를 실행하여 애플리케이션과 데이터베이스 서비스가 동시에 정상적으로 시작되는지 확인합니다. 애플리케이션이 데이터베이스에 연결하고 데이터를 읽고 쓸 수 있는지 수동으로 간단하게 확인합니다."
          },
          {
            "id": 3,
            "title": "PWA 매니페스트 (public/manifest.json) 생성 및 next.config.js 설정",
            "description": "Progressive Web Application (PWA) 기능을 활성화하기 위해 public/manifest.json 파일을 생성하고, next.config.js에 PWA 관련 설정을 추가합니다.",
            "dependencies": [],
            "details": "public/manifest.json 파일에 앱 이름, 아이콘, 시작 URL, 표시 모드 등의 PWA 정보를 정의합니다. next.config.js에 next-pwa 플러그인 또는 유사한 설정을 추가하여 서비스 워커를 등록하고 PWA 기능을 활성화합니다.",
            "status": "done",
            "testStrategy": "애플리케이션을 배포한 후 모바일 장치에서 브라우저를 통해 접속하여 '홈 화면에 추가' 기능이 정상적으로 표시되고 작동하는지 확인합니다. 추가된 아이콘으로 앱 실행 시 PWA 모드로 실행되는지 검증합니다."
          },
          {
            "id": 4,
            "title": "핵심 사용자 흐름 엔드투엔드 테스트 시나리오 작성",
            "description": "모든 사용자 역할(일반 사용자, 관리자)에 대한 등록, 로그인, 라면 대여, 재고 관리, 기록 보기 등 핵심 사용자 흐름에 대한 포괄적인 엔드투엔드 테스트 시나리오를 작성합니다.",
            "dependencies": [1, 4, 6, 8, 9],
            "details": "각 사용자 역할별로 주요 기능(회원가입/로그인, 라면 목록 조회, 라면 대여, 재고 관리, 대여 기록 조회 등)을 포함하는 테스트 케이스를 정의합니다. 각 시나리오에 대해 예상 입력값, 예상 출력값, 테스트 단계 등을 상세히 기술합니다. Playwright 또는 Cypress와 같은 도구를 사용할 경우, 해당 도구의 스크립트 형태로 작성할 수 있습니다.",
            "status": "done",
            "testStrategy": "작성된 시나리오 문서를 검토하여 누락된 흐름이나 엣지 케이스가 없는지 확인합니다. 팀원 간 교차 검토를 통해 시나리오의 완전성과 정확성을 높입니다."
          },
          {
            "id": 5,
            "title": "Docker 환경에서 애플리케이션 빌드 및 실행 확인",
            "description": "작성된 Dockerfile과 docker-compose.yml을 사용하여 애플리케이션을 Docker 환경에서 빌드하고 실행하여 모든 서비스가 정상적으로 작동하는지 확인합니다.",
            "dependencies": [1, 2, 3],
            "details": "`docker-compose up --build -d` 명령어를 사용하여 컨테이너를 백그라운드에서 실행하고, `docker logs`를 통해 각 서비스의 로그를 확인하여 오류 없이 시작되었는지 검증합니다. 웹 브라우저를 통해 애플리케이션에 접속하여 기본적인 기능(예: 메인 페이지 로드, 로그인 페이지 접근)이 작동하는지 확인합니다.",
            "status": "done",
            "testStrategy": "Docker 컨테이너 내에서 애플리케이션을 빌드하고 실행하여 모든 서비스가 올바르게 시작되고 작동하는지 확인합니다. 웹 인터페이스를 통해 최소한의 기능(홈페이지 로드, API 호출)을 수동으로 테스트합니다."
          },
          {
            "id": 6,
            "title": "작성된 엔드투엔드 테스트 실행 및 결과 검증",
            "description": "이전에 작성된 엔드투엔드 테스트 시나리오를 Docker 배포 환경에서 실행하고, 예상 결과와 비교하여 기능의 완전성과 안정성을 검증합니다.",
            "dependencies": [4, 5],
            "details": "Playwright 또는 Cypress와 같은 자동화 도구를 사용하여 테스트 스크립트를 실행하거나, 수동 테스트 케이스의 경우 단계별로 실행하여 각 시나리오의 성공 여부를 기록합니다. 발견된 버그나 문제점은 추적 시스템에 보고합니다.",
            "status": "done",
            "testStrategy": "모든 사용자 흐름에 대한 수동 또는 자동화된 엔드투엔드 테스트를 수행하여 기능의 완전성을 검증합니다. 실패한 테스트 케이스에 대해 원인을 분석하고 해당 버그를 보고합니다."
          }
        ]
      },
      {
        "id": 20,
        "title": "아이템 숨김 기능 추가",
        "description": "관리자 페이지에서 아이템을 숨김/표시 전환할 수 있는 UI를 추가하고, 키오스크 페이지에서는 숨김 처리된 아이템이 보이지 않도록 쿼리를 수정합니다. Drizzle 스키마 변경 및 마이그레이션이 필요합니다.",
        "details": "관리자 페이지(@src/app/(admin)/admin/items/ItemPageClient.tsx)에 아이템을 숨김/표시 전환할 수 있는 UI를 추가합니다. 키오스크 페이지(@src/app/(kiosk)/kiosk/KioskPageClient.tsx)에서는 `is_hidden`이 true인 아이템을 불러오지 않도록 쿼리를 수정합니다. Drizzle 스키마를 변경하고 마이그레이션을 실행해야 합니다.",
        "testStrategy": "관리자 페이지에서 아이템을 숨김 처리했을 때 키오스크 목록에서 즉시 사라지는지 확인합니다. 숨김 해제 시 다시 나타나는지 확인합니다. 데이터베이스에 `is_hidden` 상태가 올바르게 반영되는지 확인합니다.",
        "status": "pending",
        "dependencies": [],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "Drizzle 스키마에 is_hidden 컬럼 추가 및 마이그레이션",
            "description": "Drizzle 스키마의 `ramens` 테이블에 아이템의 숨김 상태를 나타내는 `is_hidden` (boolean, 기본값 false) 컬럼을 추가하고, Drizzle 마이그레이션을 실행합니다.",
            "dependencies": [],
            "details": "`lib/db/schema.ts` 파일의 `ramens` 테이블 스키마에 `is_hidden: boolean('is_hidden').default(false)` 컬럼을 추가합니다. Drizzle-kit 명령어를 사용하여 새 마이그레이션 파일을 생성하고 데이터베이스에 적용합니다.",
            "status": "done",
            "testStrategy": "Drizzle 스튜디오 또는 데이터베이스 클라이언트를 사용하여 `ramens` 테이블에 `is_hidden` 컬럼이 성공적으로 추가되었고 기본값이 `false`로 설정되었는지 확인합니다."
          },
          {
            "id": 2,
            "title": "관리자 페이지 아이템 숨김/표시 전환 UI 및 서버 액션 구현",
            "description": "관리자 페이지의 아이템 목록에서 각 아이템에 대한 숨김/표시 상태를 전환할 수 있는 UI 컴포넌트를 추가하고, 해당 상태를 업데이트하는 Next.js 서버 액션을 구현합니다.",
            "dependencies": [1],
            "details": "`src/app/(admin)/admin/items/ItemPageClient.tsx`에 각 아이템 행에 숨김/표시를 전환할 수 있는 버튼(예: 토글 스위치)을 추가합니다. 이 버튼 클릭 시 아이템의 `is_hidden` 상태를 업데이트하는 Next.js 서버 액션(예: `lib/actions/item.ts`)을 구현하며, Drizzle ORM을 사용하여 해당 아이템의 `is_hidden` 값을 변경합니다.",
            "status": "pending",
            "testStrategy": "관리자 페이지에서 특정 아이템의 숨김/표시 버튼을 여러 번 클릭하여 UI 상태와 실제 데이터베이스의 `is_hidden` 컬럼 값이 정확히 일치하는지 확인합니다. 서버 응답 및 에러 처리를 검증합니다."
          },
          {
            "id": 3,
            "title": "키오스크 페이지 아이템 조회 쿼리 수정",
            "description": "키오스크 페이지에서 아이템 목록을 불러올 때, `is_hidden` 값이 `true`인 아이템은 조회 결과에서 제외되도록 쿼리를 수정합니다.",
            "dependencies": [1],
            "details": "`src/app/(kiosk)/kiosk/KioskPageClient.tsx` (또는 해당 데이터를 불러오는 서버 컴포넌트나 API)에서 Drizzle ORM을 사용하여 아이템을 조회하는 쿼리에 `where(eq(ramens.is_hidden, false))` 조건을 추가하여 숨김 처리되지 않은 아이템만 불러오도록 수정합니다.",
            "status": "pending",
            "testStrategy": "관리자 페이지에서 특정 아이템을 숨김 처리한 후 키오스크 페이지를 새로고침하여 해당 아이템이 목록에서 사라졌는지 확인합니다. 숨김 해제 시 다시 나타나는지 확인합니다. 여러 아이템을 숨김/해제하며 일관성을 검증합니다."
          }
        ]
      },
      {
        "id": 21,
        "title": "대여 인원수에 남/녀 항목 구분 기능 추가",
        "description": "RentalDialog.tsx에서 대여 인원수에 남성/여성 항목을 구분하여 선택할 수 있는 UI를 추가합니다.",
        "status": "pending",
        "dependencies": [],
        "priority": "medium",
        "details": "src/components/item/RentalDialog.tsx 파일의 '대여 인원' 섹션에 남성/여성 선택을 위한 UI를 추가합니다. 이 선택 값은 대여 서버 액션에 함께 전달되어야 합니다.",
        "testStrategy": "성별 선택 UI가 `src/components/item/RentalDialog.tsx`에 올바르게 구현되고 작동하는지 확인합니다. 남성 또는 여성을 선택한 후 대여를 진행할 때, 선택된 성별 값이 `lib/actions/rental.ts`의 `executeRental` 서버 액션으로 성공적으로 전달되는지 확인합니다.",
        "subtasks": [
          {
            "id": 1,
            "title": "RentalDialog.tsx에 성별 선택 UI 추가 및 서버 액션 전달",
            "description": "`src/components/item/RentalDialog.tsx` 파일의 '대여 인원' 섹션에 남성/여성 선택을 위한 UI를 추가하고, 선택된 성별 값을 `executeRental` 서버 액션으로 전달하도록 수정합니다.",
            "dependencies": [],
            "details": "`RentalDialog.tsx`에 라디오 버튼 또는 셀렉트 박스를 사용하여 남성/여성 중 하나를 선택할 수 있도록 구현합니다. 이 선택 값을 `executeRental` 함수 호출 시 파라미터로 추가하여 서버로 전송해야 합니다. `lib/actions/rental.ts`의 `executeRental` 함수 시그니처를 업데이트해야 합니다.",
            "status": "pending",
            "testStrategy": "성별 선택 UI가 `src/components/item/RentalDialog.tsx`에 올바르게 구현되고 작동하는지 확인합니다. 남성 또는 여성을 선택한 후 대여를 진행할 때, 선택된 성별 값이 `lib/actions/rental.ts`의 `executeRental` 서버 액션으로 성공적으로 전달되는지 브라우저 개발자 도구의 네트워크 탭을 통해 검증합니다."
          },
          {
            "id": 2,
            "title": "generalUsers 테이블에 gender 컬럼 추가 및 마이그레이션",
            "description": "`generalUsers` 테이블에 `gender` 컬럼(예: `text('gender', { enum: ['male', 'female')`)을 추가하고 Drizzle 마이그레이션을 실행합니다.",
            "dependencies": [],
            "details": "`lib/db/schema.ts` 파일의 `generalUsers` 스키마에 `gender` 컬럼을 추가합니다. 가능한 값은 'male', 'female', 'other' 등으로 정의하고, `drizzle-kit generate` 및 `drizzle-kit push` 또는 `drizzle-kit migrate` 명령어를 사용하여 데이터베이스 스키마를 업데이트합니다.",
            "status": "done",
            "testStrategy": "마이그레이션이 성공적으로 실행되었는지 확인합니다. 데이터베이스 클라이언트를 사용하여 `generalUsers` 테이블에 `gender` 컬럼이 생성되었는지, 그리고 해당 컬럼의 제약 조건(enum, nullable 등)이 올바르게 적용되었는지 확인합니다."
          },
          {
            "id": 3,
            "title": "성별 대여 통계 Drizzle 쿼리 및 서버 액션 구현",
            "description": "`rentalRecords`와 `generalUsers` 테이블을 조인하여 성별 대여 통계를 집계하는 Drizzle 쿼리 로직을 구현하고, 이를 제공하는 서버 액션을 생성합니다.",
            "dependencies": [2],
            "details": "`lib/actions/analytics.ts`와 같은 서버 액션 파일에 `getRentalStatsByGender` 함수를 구현합니다. 이 함수는 `rentalRecords`와 `generalUsers` 테이블을 조인하고, `gender` 컬럼으로 그룹화하여 각 성별의 총 대여 횟수를 집계하는 Drizzle 쿼리를 포함해야 합니다.",
            "status": "pending",
            "testStrategy": "새로운 서버 액션(`getRentalStatsByGender`)을 직접 호출하거나 Postman/Insomnia와 같은 도구를 사용하여 예상되는 성별별 대여 통계 데이터(예: `{ male: 10, female: 15}`)가 올바르게 반환되는지 확인합니다. 여러 성별의 테스트 데이터를 생성하여 쿼리 정확성을 검증합니다."
          },
          {
            "id": 4,
            "title": "관리자 대시보드에 성별 통계 시각화 UI 추가",
            "description": "관리자 대시보드의 `RentalAnalyticsClient.tsx`에 성별 대여 통계를 시각적으로 표시하는 UI 컴포넌트(예: 원형 차트 또는 막대 차트)를 추가하고, 기존 필터링 기능과 연동합니다.",
            "dependencies": [3],
            "details": "`app/(admin)/rental/RentalAnalyticsClient.tsx` 파일에 새로운 섹션을 추가하고, 서버 액션(`getRentalStatsByGender`)을 호출하여 데이터를 가져온 후, Recharts나 Chart.js와 같은 차트 라이브러리를 사용하여 성별 대여 통계를 시각화합니다. 기존 날짜 필터링 기능과 연동하여 특정 기간의 성별 통계를 볼 수 있도록 구현합니다.",
            "status": "pending",
            "testStrategy": "관리자 대시보드(`/admin/rental`)에 접근하여 성별 대여 통계 차트 또는 테이블이 올바르게 렌더링되는지 시각적으로 확인합니다. 데이터를 변경(예: 새로운 성별 대여 기록 추가)한 후 UI가 업데이트되는지 확인합니다. 날짜 필터를 사용하여 특정 기간의 성별 통계가 정확하게 표시되는지 검증합니다."
          }
        ]
      },
      {
        "id": 22,
        "title": "아이템/사용자 삭제 시 대여 기록 보존",
        "description": "아이템이나 사용자를 삭제하더라도 관련된 대여 기록(`rentalRecords`)은 삭제되지 않고 보존되도록 데이터베이스 스키마를 수정합니다.",
        "details": "`rentalRecords` 테이블의 `itemId`와 `userId` 외래 키 제약조건에서 `ON DELETE CASCADE` 옵션을 제거하고 `ON DELETE SET NULL`로 변경합니다. 이를 위해 Drizzle 스키마를 수정하고 마이그레이션을 실행해야 합니다. `itemId`와 `userId` 컬럼은 `nullable`이어야 합니다. 삭제 로직도 soft delete로 변경하는 것을 고려합니다.",
        "testStrategy": "대여 기록이 있는 아이템과 사용자를 삭제한 후, `rentalRecords` 테이블에서 해당 기록이 삭제되지 않고 `itemId` 또는 `userId`가 NULL로 변경되었는지 확인합니다.",
        "status": "pending",
        "dependencies": [],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "rentalRecords 테이블 스키마 수정 (nullable 컬럼 및 외래 키 제약조건)",
            "description": "`lib/db/schema.ts` 파일에서 `rentalRecords` 테이블의 `itemId`와 `userId` 컬럼을 `nullable`로 변경하고, 해당 컬럼에 대한 외래 키 제약조건을 `onDelete: 'cascade'`에서 `onDelete: 'set null'`로 수정합니다.",
            "dependencies": [],
            "details": "`rentalRecords` 테이블 정의에서 `itemId`와 `userId` 필드를 `references(..., { onDelete: 'set null' }).notNull()`에서 `references(..., { onDelete: 'set null' })`로 변경하여 nullable로 만들고, `onDelete` 옵션을 수정합니다.",
            "status": "done",
            "testStrategy": "변경될 스키마 파일(`lib/db/schema.ts`)을 검토하여 `itemId`와 `userId`가 `nullable`로 정의되었는지, 그리고 `onDelete` 옵션이 `set null`로 설정되었는지 확인합니다."
          },
          {
            "id": 2,
            "title": "데이터베이스 스키마 변경을 위한 Drizzle 마이그레이션 생성 및 실행",
            "description": "Subtask 1에서 수정한 Drizzle 스키마를 기반으로 마이그레이션 스크립트를 생성하고, 데이터베이스에 해당 변경 사항을 적용합니다.",
            "dependencies": [1],
            "details": "`drizzle-kit generate` 명령어를 사용하여 새 마이그레이션 파일을 생성합니다. 생성된 SQL 마이그레이션 스크립트를 검토하여 예상대로 `ALTER TABLE` 문이 포함되어 있는지 확인합니다. 이후 `drizzle-kit push` 또는 수동으로 `drizzle-kit migrate` 명령어를 실행하여 변경 사항을 데이터베이스에 적용합니다.",
            "status": "done",
            "testStrategy": "마이그레이션 실행 후 데이터베이스 관리 도구(예: `sqlitebrowser` for SQLite)를 사용하여 `rentalRecords` 테이블의 `itemId`와 `userId` 컬럼이 `NULL` 값을 허용하도록 변경되었고, 외래 키 제약조건이 `ON DELETE SET NULL`로 설정되었는지 확인합니다."
          },
          {
            "id": 3,
            "title": "삭제 로직 및 대여 기록 UI에서 NULL 값 처리 검토 및 조정",
            "description": "아이템 또는 사용자가 삭제된 후 `rentalRecords` 테이블의 `itemId` 또는 `userId`가 `NULL`이 되는 상황을 고려하여 기존 아이템/사용자 삭제 로직과 대여 기록을 표시하는 UI 컴포넌트를 검토하고 필요한 경우 수정합니다.",
            "dependencies": [2],
            "details": "기존 아이템/사용자 삭제 서버 액션(`lib/actions/...`)을 검토하여 추가적인 변경이 필요한지 확인합니다. 대여 기록을 조회하고 표시하는 UI 컴포넌트(예: 사용자 프로필의 대여 기록 목록, 관리자 페이지의 대여 기록 상세 보기)에서 `itemId`나 `userId`가 `NULL`일 때 적절하게 처리되도록 로직을 추가하거나 수정합니다(예: '삭제된 아이템' 또는 '알 수 없는 사용자'와 같이 표시).",
            "status": "pending",
            "testStrategy": "1. 대여 기록이 있는 아이템을 삭제한 후, `rentalRecords` 테이블에서 해당 기록의 `itemId`가 `NULL`로 설정되었는지 확인하고, 관련 UI에서 기록이 올바르게 표시되는지 확인합니다. 2. 대여 기록이 있는 사용자를 삭제한 후, `rentalRecords` 테이블에서 해당 기록의 `userId`가 `NULL`로 설정되었는지 확인하고, 관련 UI에서 기록이 올바르게 표시되는지 확인합니다."
          }
        ]
      },
      {
        "id": 23,
        "title": "특정 품목 시간제 대여 및 대기자 관리 기능 구현",
        "description": "닌텐도와 같은 특정 품목에 대해 시간제 대여(예: 30분), 사용자별 대여 횟수 제한, 대기자 명단 관리 기능을 구현합니다.",
        "details": "`items` 테이블에 시간제 대여 관련 컬럼(`isTimeLimited`, `rentalTimeMinutes`, `maxRentalsPerUser`)을 추가합니다. 대기자 관리를 위한 `waiting_queue` 테이블을 새로 생성합니다. 대여 로직을 수정하여 시간제 대여 품목을 처리하고, 대여 횟수를 체크하며, 대여 중일 때 신청하면 대기자 명단에 추가하는 기능을 구현합니다. 연장은 불가능해야 합니다.",
        "testStrategy": "시간제 대여 품목을 설정하고 대여를 시도하여 정상적으로 대여되는지 확인합니다. 동일 사용자가 최대 횟수 이상 대여를 시도할 때 거부되는지 확인합니다. 품목이 대여 중일 때 다른 사용자가 대여를 시도하면 대기자 명단에 등록되는지 확인하고, 반납 시 다음 대기자에게 알림이 가는지(또는 대여 가능 상태로 바뀌는지) 테스트합니다.",
        "status": "pending",
        "dependencies": [],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "데이터베이스 스키마 정의 (items 컬럼 추가 및 waiting_queue 테이블 생성)",
            "description": "시간제 대여 관련 컬럼을 `items` 테이블에 추가하고, 대기자 관리를 위한 `waiting_queue` 테이블 스키마를 새로 정의합니다.",
            "dependencies": [],
            "details": "`lib/db/schema.ts` 파일에서 `items` 테이블에 `isTimeLimited` (boolean), `rentalTimeMinutes` (integer), `maxRentalsPerUser` (integer) 컬럼을 추가합니다. 또한, `id`, `itemId`, `userId`, `requestDate`, `status` (예: 'pending', 'granted', 'cancelled'), `grantedDate` 등의 컬럼을 포함하는 `waiting_queue` 테이블을 정의합니다. 외래 키 제약 조건 및 인덱싱을 고려합니다.",
            "status": "done",
            "testStrategy": "스키마 정의 후 `drizzle-kit generate`를 통해 마이그레이션 파일이 올바르게 생성되는지 확인합니다. 생성된 SQL 스크립트를 검토하여 테이블 및 컬럼 정의가 의도한 대로 되었는지 확인합니다."
          },
          {
            "id": 2,
            "title": "Drizzle 마이그레이션 실행",
            "description": "정의된 데이터베이스 스키마 변경사항을 데이터베이스에 적용하기 위해 Drizzle 마이그레이션을 실행합니다.",
            "dependencies": [1],
            "details": "`drizzle-kit generate` 명령어를 통해 마이그레이션 스크립트를 생성하고, 생성된 스크립트를 검토한 후 `drizzle-kit push` 또는 해당 마이그레이션 명령어를 사용하여 실제 데이터베이스에 변경사항을 적용합니다. 기존 데이터의 손실이 없도록 특히 주의합니다.",
            "status": "done",
            "testStrategy": "마이그레이션 실행 후, SQLite 브라우저와 같은 도구를 사용하여 `items` 테이블에 새로운 컬럼이 추가되고 `waiting_queue` 테이블이 올바르게 생성되었는지 확인합니다. 더미 데이터를 삽입하여 테이블이 정상 작동하는지 검증합니다."
          },
          {
            "id": 3,
            "title": "관리자 아이템 관리 UI 업데이트 (시간제 대여 설정 필드 추가)",
            "description": "관리자 페이지의 아이템 생성 및 수정 UI에 시간제 대여 관련 설정 필드를 추가합니다.",
            "dependencies": [2],
            "details": "관리자 페이지의 아이템 관리 컴포넌트(예: `admin/items/edit` 또는 `admin/items/new`)에 `isTimeLimited` (체크박스), `rentalTimeMinutes` (숫자 입력), `maxRentalsPerUser` (숫자 입력) 필드를 추가합니다. 이 필드들이 백엔드 서버 액션/API와 연동되어 `items` 테이블의 해당 컬럼에 올바르게 저장되도록 프론트엔드 로직과 백엔드 연동 로직을 구현합니다.",
            "status": "pending",
            "testStrategy": "관리자 페이지에서 새 아이템을 생성하거나 기존 아이템을 수정할 때, 새로 추가된 필드에 값을 입력하고 저장하여 데이터베이스에 올바르게 반영되는지 확인합니다. UI의 유효성 검사가 정상 작동하는지 테스트합니다."
          },
          {
            "id": 4,
            "title": "키오스크 대여 로직 수정 (시간제 대여, 횟수 제한, 대기자 등록)",
            "description": "키오스크의 대여 로직을 수정하여 시간제 대여, 사용자별 대여 횟수 제한, 그리고 대여 가능한 품목이 없을 경우 대기자 명단에 추가하는 기능을 구현합니다.",
            "dependencies": [2],
            "details": "키오스크의 아이템 대여 요청 처리 로직(서버 액션 또는 API)을 수정합니다. 품목이 `isTimeLimited`인 경우 `rentalRecords`에 `returnDueDate`를 설정하고 연장 기능을 비활성화합니다. 사용자의 해당 품목 대여 기록을 조회하여 `maxRentalsPerUser`를 초과하는지 확인하고 초과 시 대여를 거부합니다. 품목의 재고가 없거나 모두 대여 중일 경우, 사용자를 `waiting_queue` 테이블에 추가합니다. 이 모든 과정에서 동시성 문제 발생 가능성을 고려하여 트랜잭션을 적용합니다.",
            "status": "pending",
            "testStrategy": "시간제 품목을 설정하고 대여를 시도하여 `returnDueDate`가 정확한지 확인합니다. 동일 사용자가 최대 횟수 이상 대여를 시도할 때 대여가 거부되는지 테스트합니다. 품목이 모두 대여 중일 때 다른 사용자가 대여를 시도하면 `waiting_queue`에 올바르게 추가되는지 확인합니다."
          },
          {
            "id": 5,
            "title": "반납 로직 수정 및 대기자 명단 처리",
            "description": "아이템 반납 시 품목 상태를 업데이트하고, 해당 품목을 기다리는 대기자가 있을 경우 다음 대기자에게 대여 기회를 제공하는 로직을 구현합니다.",
            "dependencies": [4],
            "details": "키오스크의 아이템 반납 처리 로직을 수정합니다. 반납된 품목의 상태를 '대여 가능'으로 변경하고, `waiting_queue`에서 해당 `itemId`를 기다리는 가장 오래된(requestDate가 빠른) 대기자를 조회합니다. 대기자가 존재할 경우, 해당 대기자에게 알림을 제공하고 (예: 키오스크 UI에 '대여 가능'으로 표시) 대기자 상태를 업데이트하여 다음 대여를 준비할 수 있도록 합니다. 대기열에서 해당 대기자를 제거하는 로직도 포함합니다.",
            "status": "pending",
            "testStrategy": "시간제 품목을 대여하고, 다른 사용자를 대기자 명단에 등록한 후, 대여된 품목을 반납합니다. 반납 후 대기자 명단이 올바르게 처리되고, 다음 대기자에게 품목이 대여 가능함을 알리는 로직(예: 시스템 로그, UI 변경)이 정상 작동하는지 확인합니다. 다음 대기자가 대여를 시도할 때 성공하는지 테스트합니다."
          },
          {
            "id": 6,
            "title": "만료된 시간제 대여 처리 로직 구현",
            "description": "반납 기한이 만료된 시간제 대여를 주기적으로 확인하고 처리하는 메커니즘을 구현합니다.",
            "dependencies": [4],
            "details": "만료된 시간제 대여를 처리하기 위한 로직을 구현합니다. 이는 주기적으로 실행되는 백그라운드 작업(예: cron job, 서버리스 함수)이 될 수 있습니다. `rentalRecords` 테이블에서 `returnDueDate`가 현재 시간을 초과한 대여 기록을 조회합니다. 조회된 만료된 대여 기록의 상태를 '연체' 또는 '만료됨'으로 업데이트합니다. 품목의 재고 상태는 실제로 반납되기 전까지는 '대여 중'으로 유지되어야 합니다.",
            "status": "pending",
            "testStrategy": "시간제 품목을 대여한 후, `returnDueDate`가 지나도록 반납하지 않은 상태를 시뮬레이션합니다. 만료 처리 로직을 수동으로 실행하거나 기다린 후, `rentalRecords` 테이블에서 해당 대여 기록의 상태가 '연체' 등으로 올바르게 변경되었는지 확인합니다."
          }
        ]
      },
      {
        "id": 24,
        "title": "사용자 등록 시 개인정보 동의 파일 업로드 기능 추가",
        "description": "사용자 등록 시(관리자 페이지에서) 개인정보 동의서(DOCX, PDF)를 업로드하고 해당 파일 경로를 저장하는 기능을 추가합니다.",
        "details": "관리자 페이지의 사용자 추가 폼(@src/app/(admin)/admin/users/AddUserForm.tsx)에 파일 업로드 필드를 추가합니다. 업로드된 파일은 서버의 특정 경로(예: `/uploads/consent`)에 저장됩니다. `generalUsers` 테이블에 `consentFilePath`와 같은 컬럼을 추가하여 파일 경로를 저장합니다. Drizzle 스키마 변경 및 마이그레이션이 필요합니다.",
        "testStrategy": "사용자 추가 폼에서 동의서 파일을 업로드하여 사용자를 생성합니다. 서버에 파일이 올바르게 저장되었는지 확인하고, 데이터베이스의 `generalUsers` 테이블에 파일 경로가 정확히 기록되었는지 확인합니다. 파일 없이도 등록이 가능한지(선택 사항인 경우) 테스트합니다.",
        "status": "pending",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [
          {
            "id": 1,
            "title": "Drizzle 스키마 업데이트 및 마이그레이션",
            "description": "Drizzle 스키마에서 `generalUsers` 테이블에 `consentFilePath` 컬럼을 `TEXT` 타입으로 추가하고, 변경 사항을 데이터베이스에 적용하기 위해 마이그레이션을 생성하고 실행합니다.",
            "dependencies": [],
            "details": "`src/lib/db/schema.ts` 파일의 `generalUsers` 테이블 정의에 `consentFilePath: text('consent_file_path')`를 추가합니다. `drizzle-kit generate` 명령어를 사용하여 마이그레이션 파일을 생성하고, `drizzle-kit migrate` 명령어를 실행하여 데이터베이스에 적용합니다. `nullable` 여부도 고려하여 적절히 설정합니다.",
            "status": "done",
            "testStrategy": "데이터베이스 클라이언트를 사용하여 `generalUsers` 테이블에 `consentFilePath` 컬럼이 성공적으로 추가되었는지, 그리고 컬럼 타입이 올바른지 확인합니다."
          },
          {
            "id": 2,
            "title": "관리자 사용자 추가 폼에 파일 업로드 필드 추가",
            "description": "관리자 페이지의 사용자 추가 폼(`@src/app/(admin)/admin/users/AddUserForm.tsx`)에 개인정보 동의서 파일(DOCX, PDF)을 업로드할 수 있는 필드를 추가합니다.",
            "dependencies": [1],
            "details": "`AddUserForm.tsx` 내에 `<input type=\"file\" />` 요소를 추가하고, 허용되는 파일 형식(DOCX, PDF) 및 크기 제한에 대한 클라이언트 측 유효성 검사 힌트를 제공합니다. `shadcn/ui`의 `Input` 컴포넌트를 활용할 수 있습니다. 폼 데이터 전송 시 `multipart/form-data`를 사용하도록 설정합니다.",
            "status": "pending",
            "testStrategy": "`AddUserForm` 페이지에 접근하여 파일 업로드 필드가 시각적으로 올바르게 표시되는지 확인합니다. 다양한 파일 타입과 크기로 파일을 선택했을 때 UI/UX가 예상대로 동작하는지 확인합니다."
          },
          {
            "id": 3,
            "title": "서버 측 파일 업로드 및 저장 로직 구현",
            "description": "Next.js 서버 액션을 사용하여 `multipart/form-data` 요청을 파싱하고, 업로드된 파일의 유효성(확장자, 크기 등)을 검사한 후, 파일을 서버의 지정된 경로(`/public/uploads/consent`)에 안전하게 저장하는 로직을 구현합니다.",
            "dependencies": [2],
            "details": "새로운 서버 액션 또는 기존 사용자 생성 서버 액션 내에 `FormData` 객체에서 파일 데이터를 추출하는 로직을 구현합니다. 파일 확장자가 `.docx` 또는 `.pdf`인지, 파일 크기가 특정 한도(예: 5MB)를 초과하지 않는지 검사합니다. 검증 후, `fs` 모듈 또는 관련 유틸리티를 사용하여 파일을 `/public/uploads/consent` 경로에 고유한 이름으로 저장하고, 저장된 파일의 경로를 반환하도록 구현합니다.",
            "status": "pending",
            "testStrategy": "별도의 테스트용 서버 액션 엔드포인트를 만들어 파일 업로드 로직만 독립적으로 테스트합니다. 유효한 DOCX/PDF 파일을 업로드했을 때 서버에 파일이 생성되고 올바른 경로가 반환되는지 확인합니다. 유효하지 않은 파일 형식이나 너무 큰 파일을 업로드했을 때 적절한 에러 응답이 반환되는지 확인합니다."
          },
          {
            "id": 4,
            "title": "사용자 생성 서버 액션에 파일 경로 DB 저장 기능 통합",
            "description": "기존 사용자 생성 서버 액션을 수정하여 업로드된 개인정보 동의 파일의 경로를 받아 `generalUsers` 테이블의 `consentFilePath` 컬럼에 함께 저장하도록 통합합니다.",
            "dependencies": [1, 3],
            "details": "사용자 생성 서버 액션에서 파일 업로드 로직(서브태스크 3에서 구현)을 호출하거나 해당 로직의 반환값(파일 경로)을 받도록 수정합니다. 이후, 사용자 정보를 데이터베이스에 저장할 때 이 파일 경로도 `consentFilePath` 컬럼에 함께 기록하도록 Drizzle ORM 쿼리를 업데이트합니다. 파일 업로드 실패 시 사용자 생성도 실패하거나, 파일 경로만 `NULL`로 처리하는 예외 로직을 고려합니다.",
            "status": "pending",
            "testStrategy": "`AddUserForm`을 통해 새로운 사용자를 생성하면서 개인정보 동의 파일을 업로드합니다. 사용자 생성 후, 데이터베이스의 `generalUsers` 테이블에서 해당 사용자의 `consentFilePath` 컬럼에 파일 경로가 올바르게 저장되었는지 확인합니다. 파일 없이 사용자 생성 시 `consentFilePath`가 `NULL`로 저장되는지도 확인합니다 (선택 사항인 경우)."
          },
          {
            "id": 5,
            "title": "전체 기능 통합 테스트 및 배포 준비",
            "description": "사용자 등록 시 개인정보 동의 파일 업로드 및 저장 기능의 전체 플로우를 종단 간(End-to-End) 테스트하고, 필요한 경우 사용자 가이드 또는 개발 문서에 해당 기능을 추가합니다.",
            "dependencies": [1, 2, 3, 4],
            "details": "관리자 페이지에서 `AddUserForm`을 사용하여 다양한 시나리오로 사용자를 등록합니다. 유효한 DOCX/PDF 파일을 업로드하여 성공적인 등록과 파일 저장, DB 경로 저장 여부를 확인합니다. 유효하지 않은 파일로 시도했을 때 에러 처리가 올바른지 확인합니다. 파일 없이 등록하는 경우도 테스트합니다. 발견된 문제점을 수정하고, 필요한 경우 관리자 또는 개발자를 위한 사용법을 문서화합니다.",
            "status": "pending",
            "testStrategy": "E2E 테스트 스위트를 사용하여 다음을 검증합니다: `AddUserForm`에서 파일을 선택하고 제출했을 때, 서버에 파일이 성공적으로 업로드되고 저장되는지. 데이터베이스의 `generalUsers` 테이블에 `consentFilePath`가 올바르게 업데이트되는지. 업로드된 파일이 `uploads/consent` 경로에 물리적으로 존재하는지. 유효하지 않은 파일 형식이나 크기 제한을 초과하는 파일을 업로드했을 때 적절한 에러 메시지가 표시되는지. (선택적) 파일 없이 사용자를 생성했을 때 기능이 정상 동작하는지."
          }
        ]
      }
    ],
    "metadata": {
      "created": "2025-10-17T11:49:36.913Z",
      "updated": "2025-11-07T01:49:04.717Z",
      "description": "Tasks for master context"
    }
  }
}
